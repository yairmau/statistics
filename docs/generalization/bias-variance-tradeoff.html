<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>46&nbsp; bias-variance tradeoff – Statistics and Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../generalization/overfitting-and-underfitting.html" rel="next">
<link href="../foundations/MLE_and_bayesian_inference.html" rel="prev">
<link href="../archive/logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-a588049bcf6ba0aff1d03aeee07a0105.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2c63ad6a8cffefe8536d13eabcc001d1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TB8VQN4T5W"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TB8VQN4T5W', { 'anonymize_ip': true});
</script>
<!-- <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.2/css/all.css"> -->

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../generalization/bias-variance-tradeoff.html">generalization and model complexity</a></li><li class="breadcrumb-item"><a href="../generalization/bias-variance-tradeoff.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">bias-variance tradeoff</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../archive/logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistics and Machine Learning</a> 
        <div class="sidebar-tools-main">
    <a href="https://yairmau.com/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house-fill"></i></a>
    <a href="https://github.com/yairmau/statistics/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/height.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">height data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">weight data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">hypothesis testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/t_test_one_sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">one-sample t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/t_test_independent_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">independent samples t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/statistical_power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">statistical power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/problem-with-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">the problem with t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/permutation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">permutation test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/numpy-vs-pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">numpy vs pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/exact-vs-montecarlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">exact vs.&nbsp;Monte Carlo permutation tests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">confidence interval</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../confidence_interval/basic_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">basic concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../confidence_interval/analytical_confidence_interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">analytical confidence interval</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../confidence_interval/empirical_confidence_interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">empirical confidence interval</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/geometry-of-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">the geometry of regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/least-squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/equivalence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">equivalence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/partitioning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">partitioning of the sum of squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/mixed-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">linear mixed effect model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/logistic_2d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">logistic 2d</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">correlation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">correlation and linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/cosine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">cosine</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">significance (p-value)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">bayes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/from-the-ground-up.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Bayes’ theorem from the ground up</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/parametric-generative-classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">parametric generative classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/odds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">odds and log likelihood</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/logistic-connection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">logistic connection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/conjugate-prior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">conjugate prior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/boy-girl-paradox.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">the boy-girl paradox</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/monty-hall.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">monty hall</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">svd and pca</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../svd_and_pca/svd_image_compression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">SVD for image compression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../svd_and_pca/svd_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">SVD for regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">decision trees</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../decision_trees/CART_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">CART: classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../decision_trees/CART_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">CART: regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../decision_trees/random_forest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">random forest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">information theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../information_theory/entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">entropy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../information_theory/cross-entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">cross-entropy and KL divergence</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/probability_and_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">probability and likelihood</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/MLE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">maximum likelihood estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/MLE_and_summary_statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">MLE and summary statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/MLE_and_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">MLE and linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/MLE_and_information_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">MLE and information theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/MLE_and_regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">MLE and regularization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/MLE_and_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">MLE and classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../foundations/MLE_and_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">MLE and bayesian inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">generalization and model complexity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/bias-variance-tradeoff.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">bias-variance tradeoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/overfitting-and-underfitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">overfitting and underfitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/cross-validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">cross-validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/data-splitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">regularization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/more-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">when more data changes the tradeoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/double-descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">double descent</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">miscellaneous</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/trend_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">trend test</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#expected-squared-error" id="toc-expected-squared-error" class="nav-link active" data-scroll-target="#expected-squared-error"><span class="header-section-number">46.1</span> expected squared error</a></li>
  <li><a href="#biasvariancenoise-decomposition" id="toc-biasvariancenoise-decomposition" class="nav-link" data-scroll-target="#biasvariancenoise-decomposition"><span class="header-section-number">46.2</span> bias–variance–noise decomposition</a></li>
  <li><a href="#tradeoff" id="toc-tradeoff" class="nav-link" data-scroll-target="#tradeoff"><span class="header-section-number">46.3</span> tradeoff</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../generalization/bias-variance-tradeoff.html">generalization and model complexity</a></li><li class="breadcrumb-item"><a href="../generalization/bias-variance-tradeoff.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">bias-variance tradeoff</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">bias-variance tradeoff</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/yairmau/statistics/blob/main/generalization/bias-variance-tradeoff.ipynb">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Let’s say I’m running an experiment where I observe some data points <span class="math inline">(x, y)</span>. The process that generates this data has a true underlying function <span class="math inline">f(x)</span>, but I don’t know what it is. What’s worse, nature is noisy, so the observed data points <span class="math inline">y</span> are not exactly on the true function, but are spread around it:</p>
<p><span class="math display">
y = f(x) + \epsilon.
</span></p>
<p>Here the noise <span class="math inline">\epsilon</span> has zero mean and some standard deviation <span class="math inline">\sigma</span>.</p>
<p>See below an example.</p>
<div id="e952dbf9" class="cell" data-execution_count="68">
<details class="code-fold">
<summary>import libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4"></a>sns.set_theme(style<span class="op">=</span><span class="st">"ticks"</span>, font_scale<span class="op">=</span><span class="fl">1.2</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> warnings</span>
<span id="cb1-6"><a href="#cb1-6"></a>warnings.simplefilter(<span class="st">'ignore'</span>, np.exceptions.RankWarning)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cadebec1" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>plot</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>N <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sin(<span class="dv">4</span><span class="op">*</span>np.pi<span class="op">*</span>x) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x</span>
<span id="cb2-4"><a href="#cb2-4"></a>x_grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, N)</span>
<span id="cb2-5"><a href="#cb2-5"></a>blue <span class="op">=</span> <span class="st">"xkcd:cerulean"</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>gold <span class="op">=</span> <span class="st">"xkcd:gold"</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>pink <span class="op">=</span> <span class="st">"xkcd:hot pink"</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb2-10"><a href="#cb2-10"></a>noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.5</span>, size<span class="op">=</span>N)</span>
<span id="cb2-11"><a href="#cb2-11"></a>ax.plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">'black'</span>, label<span class="op">=</span><span class="vs">r'true function, </span><span class="dv">$</span><span class="vs">f</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a>ax.scatter(x_grid, f(x_grid) <span class="op">+</span> noise, s<span class="op">=</span><span class="dv">10</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span>blue, label<span class="op">=</span><span class="vs">r'noisy data, </span><span class="dv">$</span><span class="vs">y = f</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="vs"> </span><span class="op">+</span><span class="vs"> </span><span class="er">\</span><span class="vs">epsilon</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"x"</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>        xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb2-15"><a href="#cb2-15"></a>        ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb2-16"><a href="#cb2-16"></a>ax.set_ylabel(<span class="st">"y"</span>, rotation<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>My job is to find a function <span class="math inline">\hat{f}(x)</span> that best describes the process that generates the data, <span class="math inline">f(x)</span>. There are infinite possibilities, what should I do? Not knowing much about the true function, I decide in this tutorial to describe it using a polynomial function. The problem is not only that I need to find the best coefficients for the polynomial, but I also need to <strong>decide on the degree of the polynomial</strong>! It could be a straight line (degree 1), a parabola (degree 2), or something a lot more complex, such as a 15-degree polynomial. How do I decide on the degree of the polynomial?</p>
<p>Let’s play a little bit. At first, I’ll choose a 3rd degree polynomial (a cubic function). I’ll repeat the experiment a few times, fit a cubic function to each experiment using the least-squares method, and see how the fitted functions look like. See the plots for 8 experimental repetitions.</p>
<div id="52af85cc" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>plot 8 fitted functions from repeated experiments</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>deg <span class="op">=</span> <span class="dv">3</span>          <span class="co"># degree of the fitted polynomial</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>sigma <span class="op">=</span> <span class="fl">0.3</span>      <span class="co"># standard deviation of the noise</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>M <span class="op">=</span> <span class="dv">8</span>          <span class="co"># number of repeated experiments</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>n_train <span class="op">=</span> <span class="dv">20</span>     <span class="co"># number of observed points used to fit in each experiment</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb3-9"><a href="#cb3-9"></a>    idx <span class="op">=</span> np.random.choice(N, size<span class="op">=</span>n_train, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>    noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma, size<span class="op">=</span>n_train)</span>
<span id="cb3-11"><a href="#cb3-11"></a>    x_m <span class="op">=</span> x_grid[idx]</span>
<span id="cb3-12"><a href="#cb3-12"></a>    y_m <span class="op">=</span> f(x_m) <span class="op">+</span> noise</span>
<span id="cb3-13"><a href="#cb3-13"></a>    coeffs <span class="op">=</span> np.polyfit(x_m, y_m, deg)</span>
<span id="cb3-14"><a href="#cb3-14"></a>    p <span class="op">=</span> np.poly1d(coeffs)</span>
<span id="cb3-15"><a href="#cb3-15"></a>    l_true, <span class="op">=</span> ax[i].plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">'black'</span>, label<span class="op">=</span><span class="st">'true function'</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a>    l_data <span class="op">=</span> ax[i].scatter(x_m, y_m, s<span class="op">=</span><span class="dv">10</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span>blue)</span>
<span id="cb3-17"><a href="#cb3-17"></a>    l_fitted, <span class="op">=</span> ax[i].plot(x_grid, p(x_grid), color<span class="op">=</span>blue, label<span class="op">=</span><span class="st">'fitted function'</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>    ax[i].text(<span class="fl">0.97</span>, <span class="fl">0.97</span>, <span class="ss">f"m=</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, transform<span class="op">=</span>ax[i].transAxes,</span>
<span id="cb3-19"><a href="#cb3-19"></a>            horizontalalignment<span class="op">=</span><span class="st">'right'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,)</span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="cf">if</span> i <span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb3-21"><a href="#cb3-21"></a>        ax[i].legend([l_data, l_fitted, l_true],</span>
<span id="cb3-22"><a href="#cb3-22"></a>          [<span class="st">"data"</span>, <span class="st">"fitted function"</span>, <span class="st">"true function"</span>],</span>
<span id="cb3-23"><a href="#cb3-23"></a>          loc<span class="op">=</span><span class="st">"center left"</span>,</span>
<span id="cb3-24"><a href="#cb3-24"></a>          bbox_to_anchor<span class="op">=</span>(<span class="fl">0.0</span>,<span class="fl">1.1</span>),</span>
<span id="cb3-25"><a href="#cb3-25"></a>          frameon<span class="op">=</span><span class="va">False</span>, fancybox<span class="op">=</span><span class="va">False</span>, shadow<span class="op">=</span><span class="va">False</span>, ncol<span class="op">=</span><span class="dv">3</span>,)</span>
<span id="cb3-26"><a href="#cb3-26"></a>    <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="dv">4</span>:</span>
<span id="cb3-27"><a href="#cb3-27"></a>        ax[i].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"x"</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a>    <span class="cf">if</span> i <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-29"><a href="#cb3-29"></a>        ax[i].set_ylabel(<span class="st">"y"</span>, rotation<span class="op">=</span><span class="dv">0</span>, labelpad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb3-30"><a href="#cb3-30"></a>    ax[i].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb3-31"><a href="#cb3-31"></a>              ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb3-32"><a href="#cb3-32"></a>              xticks<span class="op">=</span>[],</span>
<span id="cb3-33"><a href="#cb3-33"></a>              yticks<span class="op">=</span>[])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that in each experiment <span class="math inline">m</span> we observe a different set of data points, and therefore we get a different fitted function <span class="math inline">{\hat{f}}_m(x)</span>. We will do the same for 200 experiments:</p>
<div id="2043b37f" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>generate data for 200 repeated experiments, and fit each of them</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>deg <span class="op">=</span> <span class="dv">3</span>          <span class="co"># degree of the fitted polynomial</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>sigma <span class="op">=</span> <span class="fl">0.3</span>      <span class="co"># standard deviation of the noise</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>M <span class="op">=</span> <span class="dv">200</span>          <span class="co"># number of repeated experiments</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>n_train <span class="op">=</span> <span class="dv">20</span>     <span class="co"># number of observed points used to fit in each experiment</span></span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># we'll store the predictions of all M fitted models on the full x_grid in this array</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>preds <span class="op">=</span> np.empty((M, N))</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="co"># choose which points are observed</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>    idx <span class="op">=</span> np.random.choice(N, size<span class="op">=</span>n_train, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="co"># generate noisy observations at those points</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>    noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma, size<span class="op">=</span>n_train)</span>
<span id="cb4-15"><a href="#cb4-15"></a>    x_m <span class="op">=</span> x_grid[idx]</span>
<span id="cb4-16"><a href="#cb4-16"></a>    y_m <span class="op">=</span> f(x_m) <span class="op">+</span> noise</span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="co"># fit a degree-deg polynomial to the observed points</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>    coeffs <span class="op">=</span> np.polyfit(x_m, y_m, deg)</span>
<span id="cb4-20"><a href="#cb4-20"></a></span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="co"># turn the fitted coefficients into a callable polynomial</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>    p <span class="op">=</span> np.poly1d(coeffs)</span>
<span id="cb4-23"><a href="#cb4-23"></a></span>
<span id="cb4-24"><a href="#cb4-24"></a>    <span class="co"># evaluate the fitted model on the full grid (common x for averaging across fits)</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>    preds[m, :] <span class="op">=</span> p(x_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2d5c67dd" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>spaghetti plot of all 200 fitted functions</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a>ax.plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="vs">r"true function, </span><span class="dv">$</span><span class="vs">f</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>ax.plot([], [], color<span class="op">=</span>blue, label<span class="op">=</span><span class="st">"fitted functions"</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb5-5"><a href="#cb5-5"></a>    ax.plot(x_grid, preds[m, :], color<span class="op">=</span>blue, alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>ax.axvline(x<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span>gold, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>ax.<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb5-9"><a href="#cb5-9"></a>       ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb5-10"><a href="#cb5-10"></a>       xlabel<span class="op">=</span><span class="st">"x"</span>,)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>ax.set_ylabel(<span class="st">"y"</span>, rotation<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A pattern seems to emerge!</p>
<p>Now, let’s focus on a tiny slice of the graph, centered at <span class="math inline">x=0.6</span> (the vertical dotted line)</p>
<div id="042dce0c" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>a thin slice</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb6-2"><a href="#cb6-2"></a>test_point <span class="op">=</span> [<span class="fl">0.6</span>, f(<span class="fl">0.6</span>)<span class="op">+</span><span class="fl">0.8</span>]</span>
<span id="cb6-3"><a href="#cb6-3"></a>ax.plot(<span class="op">*</span>test_point, ls<span class="op">=</span><span class="st">"None"</span>, marker<span class="op">=</span><span class="st">"o"</span>, markersize<span class="op">=</span><span class="dv">5</span>, mec<span class="op">=</span>pink, mfc<span class="op">=</span>pink)</span>
<span id="cb6-4"><a href="#cb6-4"></a>ax.plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="vs">r"true function, </span><span class="dv">$</span><span class="vs">f</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>ax.annotate(</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="st">""</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>    xy<span class="op">=</span>(<span class="fl">0.6</span>, f(<span class="fl">0.6</span>)),</span>
<span id="cb6-8"><a href="#cb6-8"></a>    xytext<span class="op">=</span><span class="bu">tuple</span>(test_point),</span>
<span id="cb6-9"><a href="#cb6-9"></a>    arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">"&lt;-&gt;"</span>, color<span class="op">=</span>pink, lw<span class="op">=</span><span class="fl">1.5</span>, connectionstyle<span class="op">=</span><span class="st">"bar,fraction=-0.5"</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>                    shrinkA<span class="op">=</span><span class="dv">5</span>, shrinkB<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb6-11"><a href="#cb6-11"></a>)</span>
<span id="cb6-12"><a href="#cb6-12"></a>ax.text(test_point[<span class="dv">0</span>]<span class="op">+</span><span class="fl">0.010</span>, test_point[<span class="dv">1</span>], <span class="vs">r"</span><span class="dv">$</span><span class="vs">y=f</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="op">+</span><span class="er">\</span><span class="vs">epsilon</span><span class="dv">$</span><span class="vs">"</span>, color<span class="op">=</span>pink, fontsize<span class="op">=</span><span class="dv">14</span>, ha<span class="op">=</span><span class="st">"left"</span>, va<span class="op">=</span><span class="st">"center"</span>)</span>
<span id="cb6-13"><a href="#cb6-13"></a>ax.plot([], [], color<span class="op">=</span>blue, label<span class="op">=</span><span class="vs">r"fitted functions, </span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f}_m</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb6-16"><a href="#cb6-16"></a>    ax.plot(x_grid, preds[m, :], color<span class="op">=</span>blue, alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a>ax.axvline(x<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span>gold, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb6-18"><a href="#cb6-18"></a>ax.<span class="bu">set</span>(xlim<span class="op">=</span>(<span class="fl">0.54</span>, <span class="fl">0.66</span>),</span>
<span id="cb6-19"><a href="#cb6-19"></a>       ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb6-20"><a href="#cb6-20"></a>       xlabel<span class="op">=</span><span class="st">"x"</span>,)<span class="op">;</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>ax.set_ylabel(<span class="st">"y"</span>, rotation<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The pink dot denotes a “test point”. We can think of it as representing a future measurement at <span class="math inline">x=0.6</span>. Since we now have a bunch of fitted functions, we can ask how well do we <strong>expect</strong> them to predict the value of <span class="math inline">y</span> at <span class="math inline">x=0.6</span>? Or, turning it around, how badly do we expect them to err the value of <span class="math inline">y</span> at <span class="math inline">x=0.6</span>? The error for a given fitted function at a specific <span class="math inline">x</span> value is the vertical distance between it and the test point:</p>
<p><span class="math display">
\hat{f}_m(x) - y.
</span></p>
<p>The expected squared error over all repetitions of the experiment, that is, over all fitted functions, is:</p>
<p><span class="math display">
\mathbb{E}_D[(\hat{f}(x) - y)^2\mid x],
</span></p>
<p>where the symbols <span class="math inline">|x</span> mean “given <span class="math inline">x</span>”, meaning that we are looking at the error at a specific value of <span class="math inline">x</span>.</p>
<p>This error exists because each curve was fitted (trained) on a different random dataset <span class="math inline">D</span>, and because of the noise <span class="math inline">\epsilon</span> in the test point. If we were to calculate the expected error without the square, positive and negative errors could cancel each other out, and we could get a low value even for a very bad model. By squaring the error, we make sure that all errors contribute positively to the expected error. More on that later.</p>
<section id="expected-squared-error" class="level2" data-number="46.1">
<h2 data-number="46.1" class="anchored" data-anchor-id="expected-squared-error"><span class="header-section-number">46.1</span> expected squared error</h2>
<p>What follows is a derivation of the expected squared error.</p>
<p>We start by substituting the value of <span class="math inline">y=f(x)+\epsilon</span> in the expected error: <span class="math display">
\mathbb{E}_D[(\hat{f}(x) - f(x) - \epsilon)^2\mid x].
</span></p>
<p>Let’s call <span class="math inline">A = \hat{f}(x) - f(x)</span>. Then the expected error squared becomes:</p>
<p><span class="math display">
\mathbb{E}_D[(A - \epsilon)^2\mid x].
</span></p>
<p>Expanding the square, we get:</p>
<p><span class="math display">\begin{align*}
\mathbb{E}_D[(A - \epsilon)^2\mid x] &amp;= \mathbb{E}_D[A^2 - 2A\epsilon + \epsilon^2\mid x] \\
&amp;= \underbrace{\mathbb{E}_D[A^2\mid x]}_{\text{term 1}} - 2\underbrace{\mathbb{E}_D[A\epsilon\mid x]}_{\text{term 2}} + \underbrace{\mathbb{E}_D[\epsilon^2\mid x]}_{\text{term 3}}.
\end{align*}</span></p>
<ul>
<li><p><strong>term 2:</strong> the test noise <span class="math inline">\epsilon</span> is independent of the training dataset <span class="math inline">D</span>, therefore independent of <span class="math inline">\hat{f}(x)</span> and of <span class="math inline">A</span>. Remember also that we assumed that the noise has zero mean, so <span class="math inline">\mathbb{E}[\epsilon] = 0</span>. Therefore:</p>
<p><span class="math display">
  \mathbb{E}_D[A\epsilon\mid x] = \mathbb{E}_D[A\mid x]\cdot\mathbb{E}[\epsilon] = \mathbb{E}_D[A\mid x]\cdot 0 = 0.
  </span></p></li>
<li><p><strong>term 3:</strong> we can use the identity that for a random variable <span class="math inline">\epsilon</span> with finite variance, <span class="math display">
  \mathbb{E}[\epsilon^2] = \text{Var}(\epsilon) + (\mathbb{E}[\epsilon])^2.
  </span> Since we assumed that <span class="math inline">\epsilon</span> has zero mean, the last term is zero, and we get: <span class="math display">
  \mathbb{E}_D[\epsilon^2\mid x] = \text{Var}(\epsilon) = \sigma^2.
  </span></p></li>
</ul>
<p>Let’s take stock of what we have so far. The expected error is now:</p>
<p><span class="math display">\begin{align*}
\mathbb{E}_D[(\hat{f}(x) - y)^2\mid x] &amp;= \mathbb{E}_D[A^2\mid x] + \sigma^2 \\
&amp;= \mathbb{E}_D[(\hat{f}(x) - f(x))^2\mid x] + \sigma^2.
\end{align*}</span></p>
<p>The first term is the error from the model <span class="math inline">\hat{f}</span> not matching <span class="math inline">f</span>, and the second term is an irreducible error from the noise in the data. Let’s analyze the first term a bit more.</p>
<p>We define the mean predictor at <span class="math inline">x</span> to be:</p>
<p><span class="math display">
\mu(x) = \mathbb{E}_D[\hat{f}(x)\mid x].
</span></p>
<p>Now let’s perform a little trick: we add and subtract <span class="math inline">\mu(x)</span> inside the parenthesis in the first term:</p>
<p><span class="math display">
\hat{f}(x) - f(x) = \left(\hat{f}(x) - \mu(x)\right) + \left(\mu(x) - f(x)\right).
</span></p>
<p>Now squaring it:</p>
<p><span class="math display">
(\hat{f} - f)^2 = \left(\hat{f} - \mu\right)^2 + \left(\mu - f\right)^2 + 2\left(\hat{f} - \mu\right)\left(\mu - f\right).
</span></p>
<p>What we wanted to analyze is the expected value of this expression:</p>
<p><span class="math display">\begin{align*}
\mathbb{E}_D[(\hat{f} - f)^2\mid x] &amp;=
\mathbb{E}_D\left[\left(\hat{f} - \mu\right)^2\mid x\right] \\
&amp;+ \left(\mu - f\right)^2 \\
&amp;+ 2\left(\mu - f\right)\mathbb{E}_D\left[\left(\hat{f} - \mu\right)\mid x\right]
\end{align*}</span></p>
<p>In the 2nd and 3rd terms, the term <span class="math inline">(\mu - f)</span> got out of the expectation operator <span class="math inline">\mathbb{E}</span> because it is not a random variable, it is a constant. This expression looks complicated, but it can get simpler. Let’s start with the last term. Since <span class="math inline">\mu</span> is the expected value of <span class="math inline">\hat{f}</span>, we have:</p>
<p><span class="math display">
\mathbb{E}_D\left[\left(\hat{f} - \mu\right)\mid x\right] = \mathbb{E}_D\left[\hat{f}\mid x\right] - \mu = \mu - \mu = 0.
</span></p>
<p>The very last thing we do now it to give names to the first two terms. The first term is called the <strong>variance</strong> of the model,</p>
<p><span class="math display">
\text{Var}\left[\hat{f}(x)\right] = \mathbb{E}_D\left[\left(\hat{f}(x) - \mu(x)\right)^2\mid x\right],
</span></p>
<p>and the second term is the square of the <strong>bias</strong> of the model,</p>
<p><span class="math display">
\text{Bias}^2\left[\hat{f}(x)\right] = \left(\mu(x) - f(x)\right)^2.
</span></p>
</section>
<section id="biasvariancenoise-decomposition" class="level2" data-number="46.2">
<h2 data-number="46.2" class="anchored" data-anchor-id="biasvariancenoise-decomposition"><span class="header-section-number">46.2</span> bias–variance–noise decomposition</h2>
<p>Putting everything together, we get the following decomposition of the expected squared error:</p>
<p><span class="math display">
\mathbb{E}_D[(\hat{f}(x) - y)^2\mid x] = \text{Var}\left[\hat{f}(x)\right] + \text{Bias}^2\left[\hat{f}(x)\right] + \sigma^2.
</span></p>
<p>We did all this hard work of deriving this decomposition to understand the different sources of error in our model. Hopefully, a good model will give a low expected error. Let’s see a few examples of repeated experiments, this time for polynomials of degree 3, 6, and 11.</p>
<div id="29cfcc3d" class="cell" data-execution_count="69">
<details class="code-fold">
<summary>calculate mean and std for all degrees from 1 to 15</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>degree_max <span class="op">=</span> <span class="dv">15</span>  <span class="co"># degree of the fitted polynomial</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>sigma <span class="op">=</span> <span class="fl">0.3</span>      <span class="co"># standard deviation of the noise</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>M <span class="op">=</span> <span class="dv">200</span>          <span class="co"># number of repeated experiments</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>n_train <span class="op">=</span> <span class="dv">20</span>     <span class="co"># number of observed points used to fit in each experiment</span></span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># we'll store the predictions of all M fitted models on the full x_grid in this array</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>preds15 <span class="op">=</span> np.empty((M, N, degree_max))</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="cf">for</span> deg <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, degree_max<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb7-12"><a href="#cb7-12"></a>        <span class="co"># generate a new noisy realization of the data on the fixed grid</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>        noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma, size<span class="op">=</span>N)</span>
<span id="cb7-14"><a href="#cb7-14"></a>        y <span class="op">=</span> f(x_grid) <span class="op">+</span> noise</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a>        <span class="co"># choose which n_train grid points are "observed" in this experiment</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>        idx <span class="op">=</span> np.random.choice(N, size<span class="op">=</span>n_train, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a>        <span class="co"># fit a degree-deg polynomial to the observed points</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>        coeffs <span class="op">=</span> np.polyfit(x_grid[idx], y[idx], deg)</span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a>        <span class="co"># turn the fitted coefficients into a callable polynomial</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>        p <span class="op">=</span> np.poly1d(coeffs)</span>
<span id="cb7-24"><a href="#cb7-24"></a></span>
<span id="cb7-25"><a href="#cb7-25"></a>        <span class="co"># evaluate the fitted model on the full grid (common x for averaging across fits)</span></span>
<span id="cb7-26"><a href="#cb7-26"></a>        preds15[m, :, deg<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> p(x_grid)</span>
<span id="cb7-27"><a href="#cb7-27"></a></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co"># calculate the mean prediction and its standard deviation across the M fitted models, for every point on the x-grid</span></span>
<span id="cb7-29"><a href="#cb7-29"></a>mean_pred <span class="op">=</span> preds15.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb7-30"><a href="#cb7-30"></a>std_pred  <span class="op">=</span> preds15.std(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="75f76a5c" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>plot 8 fitted functions from repeated experiments</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>degr <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">11</span>] <span class="co"># list of degrees to fit</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>sigma <span class="op">=</span> <span class="fl">0.3</span>      <span class="co"># standard deviation of the noise</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>M5 <span class="op">=</span> <span class="dv">5</span>          <span class="co"># number of repeated experiments</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>n_train <span class="op">=</span> <span class="dv">20</span>     <span class="co"># number of observed points used to fit in each experiment</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">6</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="cf">for</span> d, deg <span class="kw">in</span> <span class="bu">enumerate</span>(degr):</span>
<span id="cb8-8"><a href="#cb8-8"></a>    ax[d,<span class="dv">0</span>].set_ylabel(<span class="ss">f"deg=</span><span class="sc">{</span>deg<span class="sc">}</span><span class="ss">"</span>, labelpad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb8-10"><a href="#cb8-10"></a>        ax[d, <span class="dv">5</span>].plot(x_grid, preds15[m, :, deg<span class="op">-</span><span class="dv">1</span>], color<span class="op">=</span>blue, alpha<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a>        <span class="cf">if</span> d <span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb8-12"><a href="#cb8-12"></a>            ax[d, <span class="dv">5</span>].set_title(<span class="ss">f"200 fits"</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a>    ax[d, <span class="dv">5</span>].plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">'black'</span>, label<span class="op">=</span><span class="st">'true function'</span>, alpha<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M5):</span>
<span id="cb8-15"><a href="#cb8-15"></a>        idx <span class="op">=</span> np.random.choice(N, size<span class="op">=</span>n_train, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-16"><a href="#cb8-16"></a>        noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma, size<span class="op">=</span>n_train)</span>
<span id="cb8-17"><a href="#cb8-17"></a>        x_m <span class="op">=</span> x_grid[idx]</span>
<span id="cb8-18"><a href="#cb8-18"></a>        y_m <span class="op">=</span> f(x_m) <span class="op">+</span> noise</span>
<span id="cb8-19"><a href="#cb8-19"></a>        coeffs <span class="op">=</span> np.polyfit(x_m, y_m, deg)</span>
<span id="cb8-20"><a href="#cb8-20"></a>        p <span class="op">=</span> np.poly1d(coeffs)</span>
<span id="cb8-21"><a href="#cb8-21"></a>        l_true, <span class="op">=</span> ax[d, i].plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">'black'</span>, label<span class="op">=</span><span class="st">'true function'</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb8-22"><a href="#cb8-22"></a>        l_data <span class="op">=</span> ax[d, i].scatter(x_m, y_m, s<span class="op">=</span><span class="dv">10</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span>blue)</span>
<span id="cb8-23"><a href="#cb8-23"></a>        l_fitted, <span class="op">=</span> ax[d, i].plot(x_grid, p(x_grid), color<span class="op">=</span>blue, label<span class="op">=</span><span class="st">'fitted function'</span>)</span>
<span id="cb8-24"><a href="#cb8-24"></a>        <span class="cf">if</span> d <span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb8-25"><a href="#cb8-25"></a>            ax[<span class="dv">0</span>,i].set_title(<span class="ss">f"m=</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-26"><a href="#cb8-26"></a>        ax[d, i].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb8-27"><a href="#cb8-27"></a>                ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb8-28"><a href="#cb8-28"></a>                xticks<span class="op">=</span>[],</span>
<span id="cb8-29"><a href="#cb8-29"></a>                yticks<span class="op">=</span>[])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the top row we fitted a 3rd degree polynomial. None of the five examples shown does a great job at approximating the true function, and this is quantified by their high bias. On the other hand, at least they are all pretty similar to each other. Remember: each repeated experiment drew a different set of data points, but all 3rd order polynomials are still pretty similar to each other. This is quantified by their low variance. The last plot on the right shows 200 fitted functions, and we can see that they are all pretty similar to each other (the spaghetti is not too messy), but the overall shape in the aggregate is far from the true black curve.</p>
<p>The bottom row shows the opposite. The 11th degree polynomials are very flexible, and they can approximate the true function very well, which is quantified by their low bias. However, this flexibility comes at a cost: the fitted functions are very different from each other, and this is quantified by their high variance. Here, the spaghetti plot on the right is very messy, and the aggregate of all fitted functions is very close to the true function.</p>
<div class="alert alert-danger">
<p>High bias: We can understand that high bias means that a model is not flexible enough to capture the true function, and therefore it is systematically wrong in its predictions.</p>
High variance: We can understand that high variance means that a model is highly sensitive to the specific data points it was trained on. If we were to train the same model on a different dataset, we would get a very different fitted function.
</div>
<p>Instead of showing spaghetti plots, we can compute the mean and standard deviation of all repeated experiments. It the plot below, the mean is the blue line, and the shaded area represents ±1 standard deviation.</p>
<div id="89baaa8d" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>plot results for all degrees from 1 to 15</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">15</span>):</span>
<span id="cb9-4"><a href="#cb9-4"></a>    ax[i].plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"true function"</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a>    ax[i].plot(x_grid, mean_pred[:, i], label<span class="op">=</span><span class="ss">f"mean prediction (deg=</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">)"</span>, color<span class="op">=</span>blue)</span>
<span id="cb9-6"><a href="#cb9-6"></a>    ax[i].fill_between(x_grid, mean_pred[:, i] <span class="op">-</span> std_pred[:, i], mean_pred[:, i] <span class="op">+</span> std_pred[:, i], alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">"±1 std"</span>, color<span class="op">=</span>blue)</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>    ax[i].text(<span class="fl">0.97</span>, <span class="fl">0.97</span>, <span class="ss">f"deg=</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, transform<span class="op">=</span>ax[i].transAxes,</span>
<span id="cb9-9"><a href="#cb9-9"></a>            horizontalalignment<span class="op">=</span><span class="st">'right'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,)</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="dv">10</span>:</span>
<span id="cb9-11"><a href="#cb9-11"></a>        ax[i].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"x"</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="cf">if</span> i <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb9-13"><a href="#cb9-13"></a>        ax[i].set_ylabel(<span class="st">"y"</span>, rotation<span class="op">=</span><span class="dv">0</span>, labelpad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-14"><a href="#cb9-14"></a>    ax[i].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb9-15"><a href="#cb9-15"></a>              ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb9-16"><a href="#cb9-16"></a>              xticks<span class="op">=</span>[],</span>
<span id="cb9-17"><a href="#cb9-17"></a>              yticks<span class="op">=</span>[])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can actually see the bias and variance in these plots. To make it more clear, let’s focus on two polynomials: the 3rd degree and the 8th degree. The bias squared and the variance, shown in the middle and right columns, are just the square of the distances marked on the left column.</p>
<div id="9bf0ac03" class="cell" data-execution_count="70">
<details class="code-fold">
<summary>bias-variance decomposition for deg=3 and deg=8</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>deg_A <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"true function"</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot(x_grid, mean_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>], label<span class="op">=</span><span class="ss">f"mean prediction (deg=</span><span class="sc">{</span>deg_A<span class="sc">}</span><span class="ss">)"</span>, color<span class="op">=</span>blue)</span>
<span id="cb10-6"><a href="#cb10-6"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].fill_between(x_grid, mean_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> std_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>], mean_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> std_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">"±1 std"</span>, color<span class="op">=</span>blue)</span>
<span id="cb10-7"><a href="#cb10-7"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].set_box_aspect(<span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb10-9"><a href="#cb10-9"></a>        ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb10-10"><a href="#cb10-10"></a>        xticks<span class="op">=</span>[],</span>
<span id="cb10-11"><a href="#cb10-11"></a>        yticks<span class="op">=</span>[],</span>
<span id="cb10-12"><a href="#cb10-12"></a>        xlabel<span class="op">=</span><span class="st">"x"</span>,</span>
<span id="cb10-13"><a href="#cb10-13"></a>        ylabel<span class="op">=</span><span class="st">"deg=3"</span>)</span>
<span id="cb10-14"><a href="#cb10-14"></a>idx <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.6</span> <span class="op">*</span> <span class="bu">len</span>(x_grid))</span>
<span id="cb10-15"><a href="#cb10-15"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot([x_grid[idx]]<span class="op">*</span><span class="dv">2</span>, [f(x_grid[idx]), mean_pred[idx, deg_A<span class="op">-</span><span class="dv">1</span>]], color<span class="op">=</span>gold, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-16"><a href="#cb10-16"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].plot([x_grid[idx]]<span class="op">*</span><span class="dv">2</span>, [mean_pred[idx, deg_A<span class="op">-</span><span class="dv">1</span>], mean_pred[idx, deg_A<span class="op">-</span><span class="dv">1</span>]<span class="op">-</span>std_pred[idx, deg_A<span class="op">-</span><span class="dv">1</span>]], color<span class="op">=</span>pink, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].plot(x_grid, (f(x_grid)<span class="op">-</span>mean_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"true function"</span>)</span>
<span id="cb10-19"><a href="#cb10-19"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].fill_between(x_grid, <span class="dv">0</span>, (f(x_grid)<span class="op">-</span>mean_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span>gold, label<span class="op">=</span><span class="st">"bias^2"</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].plot(x_grid, (std_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"true function"</span>)</span>
<span id="cb10-21"><a href="#cb10-21"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].fill_between(x_grid, <span class="dv">0</span>, (std_pred[:, deg_A<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span>pink, label<span class="op">=</span><span class="st">"variance"</span>)</span>
<span id="cb10-22"><a href="#cb10-22"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].set_box_aspect(<span class="dv">1</span>)</span>
<span id="cb10-23"><a href="#cb10-23"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].set_box_aspect(<span class="dv">1</span>)</span>
<span id="cb10-24"><a href="#cb10-24"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb10-25"><a href="#cb10-25"></a>        ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb10-26"><a href="#cb10-26"></a>        xticks<span class="op">=</span>[],</span>
<span id="cb10-27"><a href="#cb10-27"></a>        xlabel<span class="op">=</span><span class="st">"x"</span>,</span>
<span id="cb10-28"><a href="#cb10-28"></a>        yticks<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">2</span>])</span>
<span id="cb10-29"><a href="#cb10-29"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb10-30"><a href="#cb10-30"></a>        ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb10-31"><a href="#cb10-31"></a>        xticks<span class="op">=</span>[],</span>
<span id="cb10-32"><a href="#cb10-32"></a>        xlabel<span class="op">=</span><span class="st">"x"</span>,</span>
<span id="cb10-33"><a href="#cb10-33"></a>        yticks<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">2</span>])</span>
<span id="cb10-34"><a href="#cb10-34"></a></span>
<span id="cb10-35"><a href="#cb10-35"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].text(<span class="fl">0.5</span>, <span class="fl">0.97</span>, <span class="vs">r"Bias</span><span class="dv">$^</span><span class="vs">2</span><span class="dv">$</span><span class="vs">"</span>, transform<span class="op">=</span>ax[<span class="dv">0</span>,<span class="dv">1</span>].transAxes,</span>
<span id="cb10-36"><a href="#cb10-36"></a>         horizontalalignment<span class="op">=</span><span class="st">'center'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,)</span>
<span id="cb10-37"><a href="#cb10-37"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].text(<span class="fl">0.5</span>, <span class="fl">0.97</span>, <span class="vs">r"Variance"</span>, transform<span class="op">=</span>ax[<span class="dv">0</span>,<span class="dv">2</span>].transAxes,</span>
<span id="cb10-38"><a href="#cb10-38"></a>         horizontalalignment<span class="op">=</span><span class="st">'center'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,)</span>
<span id="cb10-39"><a href="#cb10-39"></a></span>
<span id="cb10-40"><a href="#cb10-40"></a></span>
<span id="cb10-41"><a href="#cb10-41"></a></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="co">###</span></span>
<span id="cb10-43"><a href="#cb10-43"></a></span>
<span id="cb10-44"><a href="#cb10-44"></a>deg_B <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb10-45"><a href="#cb10-45"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(x_grid, f(x_grid), color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"true function"</span>)</span>
<span id="cb10-46"><a href="#cb10-46"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot(x_grid, mean_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>], label<span class="op">=</span><span class="ss">f"mean prediction (deg=</span><span class="sc">{</span>deg_B<span class="sc">}</span><span class="ss">)"</span>, color<span class="op">=</span>blue)</span>
<span id="cb10-47"><a href="#cb10-47"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].fill_between(x_grid, mean_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> std_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>], mean_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> std_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">"±1 std"</span>, color<span class="op">=</span>blue)</span>
<span id="cb10-48"><a href="#cb10-48"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].set_box_aspect(<span class="dv">1</span>)</span>
<span id="cb10-49"><a href="#cb10-49"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb10-50"><a href="#cb10-50"></a>        ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb10-51"><a href="#cb10-51"></a>        xticks<span class="op">=</span>[],</span>
<span id="cb10-52"><a href="#cb10-52"></a>        yticks<span class="op">=</span>[],</span>
<span id="cb10-53"><a href="#cb10-53"></a>        xlabel<span class="op">=</span><span class="st">"x"</span>,</span>
<span id="cb10-54"><a href="#cb10-54"></a>        ylabel<span class="op">=</span><span class="st">"deg=8"</span>)</span>
<span id="cb10-55"><a href="#cb10-55"></a>idx <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.13</span> <span class="op">*</span> <span class="bu">len</span>(x_grid))</span>
<span id="cb10-56"><a href="#cb10-56"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot([x_grid[idx]]<span class="op">*</span><span class="dv">2</span>, [f(x_grid[idx]), mean_pred[idx, deg_B<span class="op">-</span><span class="dv">1</span>]], color<span class="op">=</span>gold, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-57"><a href="#cb10-57"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].plot([x_grid[idx]]<span class="op">*</span><span class="dv">2</span>, [mean_pred[idx, deg_B<span class="op">-</span><span class="dv">1</span>], mean_pred[idx, deg_B<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span>std_pred[idx, deg_B<span class="op">-</span><span class="dv">1</span>]], color<span class="op">=</span>pink, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-58"><a href="#cb10-58"></a></span>
<span id="cb10-59"><a href="#cb10-59"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].plot(x_grid, (f(x_grid)<span class="op">-</span>mean_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"true function"</span>)</span>
<span id="cb10-60"><a href="#cb10-60"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].fill_between(x_grid, <span class="dv">0</span>, (f(x_grid)<span class="op">-</span>mean_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span>gold, label<span class="op">=</span><span class="st">"bias^2"</span>)</span>
<span id="cb10-61"><a href="#cb10-61"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].plot(x_grid, (std_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"true function"</span>)</span>
<span id="cb10-62"><a href="#cb10-62"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].fill_between(x_grid, <span class="dv">0</span>, (std_pred[:, deg_B<span class="op">-</span><span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span>pink, label<span class="op">=</span><span class="st">"variance"</span>)</span>
<span id="cb10-63"><a href="#cb10-63"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].set_box_aspect(<span class="dv">1</span>)</span>
<span id="cb10-64"><a href="#cb10-64"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].set_box_aspect(<span class="dv">1</span>)</span>
<span id="cb10-65"><a href="#cb10-65"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb10-66"><a href="#cb10-66"></a>        ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb10-67"><a href="#cb10-67"></a>        xticks<span class="op">=</span>[],</span>
<span id="cb10-68"><a href="#cb10-68"></a>        xlabel<span class="op">=</span><span class="st">"x"</span>,</span>
<span id="cb10-69"><a href="#cb10-69"></a>        yticks<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">2</span>])</span>
<span id="cb10-70"><a href="#cb10-70"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x_grid[<span class="dv">0</span>], x_grid[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb10-71"><a href="#cb10-71"></a>        ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb10-72"><a href="#cb10-72"></a>        xticks<span class="op">=</span>[],</span>
<span id="cb10-73"><a href="#cb10-73"></a>        xlabel<span class="op">=</span><span class="st">"x"</span>,</span>
<span id="cb10-74"><a href="#cb10-74"></a>        yticks<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">2</span>])</span>
<span id="cb10-75"><a href="#cb10-75"></a></span>
<span id="cb10-76"><a href="#cb10-76"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].text(<span class="fl">0.5</span>, <span class="fl">0.97</span>, <span class="vs">r"Bias</span><span class="dv">$^</span><span class="vs">2</span><span class="dv">$</span><span class="vs">"</span>, transform<span class="op">=</span>ax[<span class="dv">1</span>,<span class="dv">1</span>].transAxes,</span>
<span id="cb10-77"><a href="#cb10-77"></a>         horizontalalignment<span class="op">=</span><span class="st">'center'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,)</span>
<span id="cb10-78"><a href="#cb10-78"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].text(<span class="fl">0.5</span>, <span class="fl">0.97</span>, <span class="vs">r"Variance"</span>, transform<span class="op">=</span>ax[<span class="dv">1</span>,<span class="dv">2</span>].transAxes,</span>
<span id="cb10-79"><a href="#cb10-79"></a>         horizontalalignment<span class="op">=</span><span class="st">'center'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tradeoff" class="level2" data-number="46.3">
<h2 data-number="46.3" class="anchored" data-anchor-id="tradeoff"><span class="header-section-number">46.3</span> tradeoff</h2>
<div id="1b3fe6e1" class="cell" data-execution_count="200">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb11-2"><a href="#cb11-2"></a>ax.plot(degrees, bias2_list, label<span class="op">=</span><span class="st">"Bias²"</span>, marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">"xkcd:goldenrod"</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># ax.plot(degrees, bias2_list, label="Bias²", marker='o', color=gold)</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>ax.plot(degrees, var_list, label<span class="op">=</span><span class="st">"Variance"</span>, marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span>blue)</span>
<span id="cb11-5"><a href="#cb11-5"></a>ax.plot(degrees, np.array(bias2_list) <span class="op">+</span> np.array(var_list), label<span class="op">=</span><span class="st">"Total Error"</span>, marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'xkcd:forest'</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>ax.set_yscale(<span class="st">"log"</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Polynomial Degree"</span>,</span>
<span id="cb11-8"><a href="#cb11-8"></a>       ylabel<span class="op">=</span><span class="st">"Error"</span>,</span>
<span id="cb11-9"><a href="#cb11-9"></a>       xticks<span class="op">=</span>degrees,</span>
<span id="cb11-10"><a href="#cb11-10"></a>       title<span class="op">=</span><span class="st">"Bias-Variance Tradeoff"</span>,</span>
<span id="cb11-11"><a href="#cb11-11"></a>       ylim<span class="op">=</span>(<span class="fl">1e-3</span>, <span class="fl">2e2</span>))<span class="op">;</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>ax.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7fae9601" class="cell" data-execution_count="118">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="im">from</span> numpy.polynomial <span class="im">import</span> Chebyshev</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># setup</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>N <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>x_grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, N)</span>
<span id="cb12-8"><a href="#cb12-8"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sin(<span class="dv">4</span><span class="op">*</span>np.pi<span class="op">*</span>x) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a>sigma <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>M <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>n_train <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>degrees <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">16</span>)</span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co"># pre-generate randomness once (shared across all degrees)</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>noise_mat <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma, size<span class="op">=</span>(M, N))</span>
<span id="cb12-17"><a href="#cb12-17"></a>idx_mat <span class="op">=</span> np.array([np.random.choice(N, size<span class="op">=</span>n_train, replace<span class="op">=</span><span class="va">False</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(M)])</span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a>bias2_list <span class="op">=</span> []</span>
<span id="cb12-20"><a href="#cb12-20"></a>var_list <span class="op">=</span> []</span>
<span id="cb12-21"><a href="#cb12-21"></a></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="cf">for</span> deg <span class="kw">in</span> degrees:</span>
<span id="cb12-23"><a href="#cb12-23"></a>    preds <span class="op">=</span> np.empty((M, N))</span>
<span id="cb12-24"><a href="#cb12-24"></a></span>
<span id="cb12-25"><a href="#cb12-25"></a>    <span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb12-26"><a href="#cb12-26"></a>        <span class="co"># generate dataset m (same x_grid, new noise)</span></span>
<span id="cb12-27"><a href="#cb12-27"></a>        y <span class="op">=</span> f(x_grid) <span class="op">+</span> noise_mat[m]</span>
<span id="cb12-28"><a href="#cb12-28"></a></span>
<span id="cb12-29"><a href="#cb12-29"></a>        <span class="co"># observe subset for training</span></span>
<span id="cb12-30"><a href="#cb12-30"></a>        idx <span class="op">=</span> idx_mat[m]</span>
<span id="cb12-31"><a href="#cb12-31"></a></span>
<span id="cb12-32"><a href="#cb12-32"></a>        <span class="co"># fit with a numerically stable polynomial basis (chebyshev)</span></span>
<span id="cb12-33"><a href="#cb12-33"></a>        p <span class="op">=</span> Chebyshev.fit(x_grid[idx], y[idx], deg, domain<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb12-34"><a href="#cb12-34"></a></span>
<span id="cb12-35"><a href="#cb12-35"></a>        <span class="co"># evaluate on the common grid</span></span>
<span id="cb12-36"><a href="#cb12-36"></a>        preds[m] <span class="op">=</span> p(x_grid)</span>
<span id="cb12-37"><a href="#cb12-37"></a></span>
<span id="cb12-38"><a href="#cb12-38"></a>    mean_pred <span class="op">=</span> preds.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-39"><a href="#cb12-39"></a>    std_pred <span class="op">=</span> preds.std(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-40"><a href="#cb12-40"></a></span>
<span id="cb12-41"><a href="#cb12-41"></a>    <span class="co"># bias^2 and variance aggregated over x</span></span>
<span id="cb12-42"><a href="#cb12-42"></a>    bias2_list.append(np.mean((mean_pred <span class="op">-</span> f(x_grid))<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb12-43"><a href="#cb12-43"></a>    var_list.append(np.mean(std_pred<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb12-44"><a href="#cb12-44"></a></span>
<span id="cb12-45"><a href="#cb12-45"></a>bias2_arr <span class="op">=</span> np.array(bias2_list)</span>
<span id="cb12-46"><a href="#cb12-46"></a>var_arr <span class="op">=</span> np.array(var_list)</span>
<span id="cb12-47"><a href="#cb12-47"></a></span>
<span id="cb12-48"><a href="#cb12-48"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb12-49"><a href="#cb12-49"></a>ax.plot(degrees, bias2_arr, marker<span class="op">=</span><span class="st">"o"</span>, label<span class="op">=</span><span class="st">"bias²"</span>)</span>
<span id="cb12-50"><a href="#cb12-50"></a>ax.plot(degrees, var_arr, marker<span class="op">=</span><span class="st">"o"</span>, label<span class="op">=</span><span class="st">"variance"</span>)</span>
<span id="cb12-51"><a href="#cb12-51"></a>ax.plot(degrees, bias2_arr <span class="op">+</span> var_arr, marker<span class="op">=</span><span class="st">"o"</span>, label<span class="op">=</span><span class="st">"bias² + variance"</span>)</span>
<span id="cb12-52"><a href="#cb12-52"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"polynomial degree"</span>, ylabel<span class="op">=</span><span class="st">"error"</span>, title<span class="op">=</span><span class="st">"bias-variance tradeoff"</span>)</span>
<span id="cb12-53"><a href="#cb12-53"></a>ax.set_yscale(<span class="st">"log"</span>)</span>
<span id="cb12-54"><a href="#cb12-54"></a>ax.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bias-variance-tradeoff_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../foundations/MLE_and_bayesian_inference.html" class="pagination-link" aria-label="MLE and bayesian inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">MLE and bayesian inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../generalization/overfitting-and-underfitting.html" class="pagination-link" aria-label="overfitting and underfitting">
        <span class="nav-page-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">overfitting and underfitting</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>