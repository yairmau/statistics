<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>28&nbsp; conjugate prior – Statistics and Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../bayes/boy-girl-paradox.html" rel="next">
<link href="../bayes/logistic-connection.html" rel="prev">
<link href="../archive/logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-a588049bcf6ba0aff1d03aeee07a0105.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2c63ad6a8cffefe8536d13eabcc001d1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TB8VQN4T5W"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TB8VQN4T5W', { 'anonymize_ip': true});
</script>
<!-- <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.2/css/all.css"> -->

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../bayes/from-the-ground-up.html">bayes</a></li><li class="breadcrumb-item"><a href="../bayes/conjugate-prior.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">conjugate prior</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../archive/logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistics and Machine Learning</a> 
        <div class="sidebar-tools-main">
    <a href="https://yairmau.com/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house-fill"></i></a>
    <a href="https://github.com/yairmau/statistics/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/height.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">height data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">weight data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">hypothesis testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/t_test_one_sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">one-sample t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/t_test_independent_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">independent samples t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/statistical_power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">statistical power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/problem-with-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">the problem with t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/permutation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">permutation test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/numpy-vs-pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">numpy vs pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hypothesis_testing/exact-vs-montecarlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">exact vs.&nbsp;Monte Carlo permutation tests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">confidence interval</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../confidence_interval/basic_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">basic concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../confidence_interval/analytical_confidence_interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">analytical confidence interval</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../confidence_interval/empirical_confidence_interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">empirical confidence interval</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/geometry-of-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">the geometry of regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/least-squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/equivalence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">equivalence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/partitioning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">partitioning of the sum of squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/mixed-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">linear mixed effect model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/logistic_2d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">logistic 2d</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">correlation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">correlation and linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/cosine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">cosine</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlation/significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">significance (p-value)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">bayes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/from-the-ground-up.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Bayes’ theorem from the ground up</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/parametric-generative-classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">parametric generative classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/odds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">odds and log likelihood</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/logistic-connection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">logistic connection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/conjugate-prior.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">conjugate prior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/boy-girl-paradox.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">the boy-girl paradox</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayes/monty-hall.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">monty hall</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">svd and pca</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../svd_and_pca/svd_image_compression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">SVD for image compression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../svd_and_pca/svd_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">SVD for regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">decision trees</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../decision_trees/CART_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">CART: classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../decision_trees/CART_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">CART: regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../decision_trees/random_forest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">random forest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">information theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../information_theory/entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">entropy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../information_theory/cross-entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">cross-entropy and KL divergence</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/probability_and_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">probability and likelihood</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/MLE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">maximum likelihood estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/MLE_and_summary_statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">MLE and summary statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/MLE_and_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">MLE and linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/MLE_and_information_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">MLE and information theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/MLE_and_regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">MLE and regularization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/MLE_and_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">MLE and classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../likelihood/MLE_and_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">MLE and bayesian inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">generalization and model complexity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/bias-variance-tradeoff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">bias-variance tradeoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/overfitting-and-underfitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">overfitting and underfitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/cross-validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">cross-validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/data-splitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">regularization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/more-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">when more data changes the tradeoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalization/double-descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">double descent</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">miscellaneous</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/trend_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">trend test</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#question" id="toc-question" class="nav-link active" data-scroll-target="#question"><span class="header-section-number">28.1</span> question</a></li>
  <li><a href="#bayes-theorem" id="toc-bayes-theorem" class="nav-link" data-scroll-target="#bayes-theorem"><span class="header-section-number">28.2</span> bayes’ theorem</a></li>
  <li><a href="#modeling-the-likelihood" id="toc-modeling-the-likelihood" class="nav-link" data-scroll-target="#modeling-the-likelihood"><span class="header-section-number">28.3</span> modeling the likelihood</a></li>
  <li><a href="#modeling-the-prior" id="toc-modeling-the-prior" class="nav-link" data-scroll-target="#modeling-the-prior"><span class="header-section-number">28.4</span> modeling the prior</a></li>
  <li><a href="#posterior-looks-like-an-updated-prior" id="toc-posterior-looks-like-an-updated-prior" class="nav-link" data-scroll-target="#posterior-looks-like-an-updated-prior"><span class="header-section-number">28.5</span> posterior looks like an updated prior</a></li>
  <li><a href="#iterative-updating-of-beliefs" id="toc-iterative-updating-of-beliefs" class="nav-link" data-scroll-target="#iterative-updating-of-beliefs"><span class="header-section-number">28.6</span> iterative updating of beliefs</a></li>
  <li><a href="#comparison-with-frequentist-approach" id="toc-comparison-with-frequentist-approach" class="nav-link" data-scroll-target="#comparison-with-frequentist-approach"><span class="header-section-number">28.7</span> comparison with frequentist approach</a></li>
  <li><a href="#conjugate-pairs" id="toc-conjugate-pairs" class="nav-link" data-scroll-target="#conjugate-pairs"><span class="header-section-number">28.8</span> conjugate pairs</a>
  <ul class="collapse">
  <li><a href="#poisson-distribution" id="toc-poisson-distribution" class="nav-link" data-scroll-target="#poisson-distribution"><span class="header-section-number">28.8.1</span> Poisson distribution</a></li>
  <li><a href="#normal-distribution-known-variance" id="toc-normal-distribution-known-variance" class="nav-link" data-scroll-target="#normal-distribution-known-variance"><span class="header-section-number">28.8.2</span> normal distribution (known variance)</a></li>
  <li><a href="#categorical-multinomial-distribution" id="toc-categorical-multinomial-distribution" class="nav-link" data-scroll-target="#categorical-multinomial-distribution"><span class="header-section-number">28.8.3</span> categorical / multinomial distribution</a></li>
  </ul></li>
  <li><a href="#uniform-distribution-known-bounds" id="toc-uniform-distribution-known-bounds" class="nav-link" data-scroll-target="#uniform-distribution-known-bounds"><span class="header-section-number">28.9</span> uniform distribution (known bounds)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../bayes/from-the-ground-up.html">bayes</a></li><li class="breadcrumb-item"><a href="../bayes/conjugate-prior.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">conjugate prior</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">conjugate prior</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/yairmau/statistics/blob/main/bayes/conjugate-prior.ipynb">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We will learn about conjugate priors in Bayesian statistics from a concrete example. Once we understand it, we will generalize the idea.</p>
<section id="question" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="question"><span class="header-section-number">28.1</span> question</h2>
<p>Let’s use here the same example from the chapter on <a href="../information_theory/cross-entropy.html">cross-entropy and KL divergence</a>:</p>
<blockquote class="blockquote">
<p>Assume I live in city A, where it rains 50% of the days. A friend of mine lives in city B, where it rains 10% of the days. What happens when my friend visits me in city A and, not knowing any better, assumes that it rains 10% of the days?</p>
</blockquote>
<p>The specific question we want to answer is: how can my friend update their belief about the probability of rain when they arrive in city A?</p>
</section>
<section id="bayes-theorem" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="bayes-theorem"><span class="header-section-number">28.2</span> bayes’ theorem</h2>
<p>We will use Bayes’ theorem to update our friend’s belief. To makes things easier to remember, let’s call the hypothesis <span class="math inline">p</span> (the probability of rain), and the evidence <span class="math inline">R</span> (a specific observation of rain or no rain). Thus, Bayes’ theorem can be rewritten as:</p>
<p><span class="math display">\begin{align}
P(p|R) &amp;= \frac{P(R|p)\cdot P(p)}{P(R)} \\
\text{posterior}&amp;= \frac{\text{likelihood}\cdot \text{prior}}{\text{evidence}}
\end{align}</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">p</span> is the hypothesis, the probability of rain.</li>
<li><span class="math inline">R</span> is the evidence, the observation of rain or no rain.</li>
<li><span class="math inline">P(p)</span> is the prior probability, our friend’s initial belief about the probability of rain.</li>
<li><span class="math inline">P(R|p)</span> is the likelihood, the likelihood of observing rain given the hypothesis that it rains with a certain probability.</li>
<li><span class="math inline">P(R)</span> is the evidence, the total probability of observing the evidence.</li>
<li><span class="math inline">P(p|R)</span> is the posterior probability, this is what we want to find: our friend’s updated belief about the probability of rain <span class="math inline">p</span> after observing the evidence.</li>
</ul>
</section>
<section id="modeling-the-likelihood" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="modeling-the-likelihood"><span class="header-section-number">28.3</span> modeling the likelihood</h2>
<p>In this problem, every day that passes it either rains or it does not rain. This can be understood as a Bernoulli process, where each day is an independent trial with two possible outcomes. “Success” would be ocurrence of rain (<span class="math inline">R=1</span>), which happens with probability <span class="math inline">p</span>. “Failure” would be no rain (<span class="math inline">R=0</span>), which happens with probability <span class="math inline">1-p</span>. In mathematical terms, the likelihood can be modeled as:</p>
<p><span class="math display">
P(R=r|p) =
\begin{cases}
p &amp; \text{if } r=1 \\
1-p &amp; \text{if } r=0
\end{cases}.
</span></p>
<p>This can be more compactly written as:</p>
<p><span class="math display">
P(R=r|p) = p^r (1-p)^{1-r}.
</span></p>
<p>This equation describes only one observation. However, we can extend it to multiple observations. Suppose our friend observes, over a total of <span class="math inline">n</span> days, <span class="math inline">k</span> days of rain and <span class="math inline">n-k</span> days of no rain. The likelihood of observing this specific sequence of rain and no rain, given the probability <span class="math inline">p</span>, can be modeled using the binomial distribution, which is the natural extension of the Bernoulli process for multiple trials:</p>
<p><span class="math display">
P(R=k|p) = \binom{n}{k} p^k (1-p)^{n-k}.
</span></p>
<p>This is the time to be more precise. When we previously said that “<span class="math inline">p</span> is the hypothesis, the probability of rain”, we left behind the modeling aspect. We assumed here a generative model, the Bernoulli process. Rephrasing the statement more precisely: “<span class="math inline">p</span> is the parameter of the generative model (Bernoulli process) that generates the observations of rain and no rain”.</p>
</section>
<section id="modeling-the-prior" class="level2" data-number="28.4">
<h2 data-number="28.4" class="anchored" data-anchor-id="modeling-the-prior"><span class="header-section-number">28.4</span> modeling the prior</h2>
<p>The prior in the Bayesian framework is not a single value. From the question above, we might think that our friend’s prior belief about the probability of rain is simply <span class="math inline">0.1=10\%</span>. However, in Bayesian statistics, the prior is represented as a probability distribution over all possible values of <span class="math inline">p</span>. In would make sense to choose a probability distribution that is highest around <span class="math inline">0.1</span> and lower elsewhere. There are infinite possible distributions that could represent this belief, so which should we choose? See below three examples of possible prior distributions, all have their mean at <span class="math inline">0.1</span>.</p>
<div id="5ef90770" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>import libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> matplotlib.gridspec <span class="im">as</span> grid_spec</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta, norm, uniform, binom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="36fcfe1d" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>plot various possible distributions</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb2-2"><a href="#cb2-2"></a>location <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>p <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>ax.plot(p, beta.pdf(p, <span class="dv">2</span>, <span class="dv">2</span><span class="op">/</span>location<span class="op">-</span><span class="dv">2</span>), label<span class="op">=</span><span class="st">'Beta(2, 18)'</span>, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>ax.plot(p, norm.pdf(p, loc<span class="op">=</span>location, scale<span class="op">=</span><span class="fl">0.02</span>), label<span class="op">=</span><span class="st">'Normal(0.1, 0.05)'</span>, color<span class="op">=</span><span class="st">"tab:orange"</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>ax.plot(p, uniform.pdf(p, loc<span class="op">=</span>location<span class="op">-</span><span class="fl">0.05</span>, scale<span class="op">=</span><span class="fl">0.1</span>), label<span class="op">=</span><span class="st">'Uniform(0.05, 0.15)'</span>, color<span class="op">=</span><span class="st">"tab:blue"</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>ax.legend(frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Probability of rain (p)'</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>       ylabel<span class="op">=</span><span class="st">'Probability Density'</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>       title<span class="op">=</span><span class="st">'Possible prior distributions for the probability of rain'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="conjugate-prior_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A particular good choice is the Beta distribution. The Beta distribution is defined on the interval [0, 1], which makes it suitable for modeling probabilities. It is parameterized by two positive shape parameters, <span class="math inline">\alpha</span> and <span class="math inline">\beta</span>, which determine the shape of the distribution. The probability density function (PDF) of the Beta distribution is given by:</p>
<p><span class="math display">
\text{Beta}(p|\alpha, \beta) = \frac{p^{\alpha - 1} (1-p)^{\beta - 1}}{B(\alpha, \beta)},
</span></p>
<p>where <span class="math inline">B(\alpha, \beta)</span> is the Beta function, which serves as a normalization constant to ensure that the total probability integrates to 1.</p>
<p>The Beta distribution in the graph above is <span class="math inline">\text{Beta}(p|\alpha=2, \beta=18)</span>. How did I choose these parameters? The mean of a Beta distribution is given by:</p>
<p><span class="math display">
\text{mean} = \frac{\alpha}{\alpha + \beta}.
</span></p>
<p>The derivation of this formula is not shown here, but it involves calculating the expected value of the distribution using its pdf, and using properties of the Beta function and of the Gamma function. Indeed, by choosing <span class="math inline">\alpha=2</span> and <span class="math inline">\beta=18</span>, we get a mean of <span class="math inline">0.1</span>.</p>
<p>Intuitively, a rain probability of <span class="math inline">0.1</span> means that out of every <span class="math inline">n</span> days, we expect it to rain on average <span class="math inline">0.1n</span> days. It terms of “successes” and “failures”:</p>
<p><span class="math display">\begin{align*}
\text{mean} &amp;= \frac{\alpha}{\alpha + \beta} \\
&amp;= \frac{\text{expected successes}}{\text{expected successes} + \text{expected failures}} \\
&amp;= \frac{\text{expected successes}}{\text{total number of trials}}
\end{align*}</span></p>
<p>Instead of choosing <span class="math inline">\alpha=2</span> and <span class="math inline">\beta=18</span>, we could choose other values that maintain the same mean but represent different levels of confidence or prior knowledge. See the three Beta distributions plotted below. All have their mean at <span class="math inline">0.1</span>, but the black one (<span class="math inline">\alpha=2, \beta=18</span>) is more spread out, indicating less certainty about the probability of rain when only <span class="math inline">2+18=20</span> days are considered. Increasing the number of days to <span class="math inline">50</span> (orange, <span class="math inline">\alpha=5, \beta=45</span>) or <span class="math inline">200</span> (blue, <span class="math inline">\alpha=20, \beta=180</span>) makes the distribution more peaked around the mean, indicating greater confidence in the estimate of the probability of rain.</p>
<div id="c62caa2a" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>three beta distributions</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a>location <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>p <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>ax.plot(p, beta.pdf(p, <span class="dv">2</span>, <span class="dv">2</span><span class="op">/</span>location<span class="op">-</span><span class="dv">2</span>), label<span class="op">=</span><span class="st">'Beta(2, 18)'</span>, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>ax.plot(p, beta.pdf(p, <span class="dv">5</span>, <span class="dv">5</span><span class="op">/</span>location<span class="op">-</span><span class="dv">5</span>), label<span class="op">=</span><span class="st">'Beta(5, 45)'</span>, color<span class="op">=</span><span class="st">"tab:orange"</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>ax.plot(p, beta.pdf(p, <span class="dv">20</span>, <span class="dv">20</span><span class="op">/</span>location<span class="op">-</span><span class="dv">20</span>), label<span class="op">=</span><span class="st">'Beta(20, 180)'</span>, color<span class="op">=</span><span class="st">"tab:blue"</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>ax.legend(frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Probability of rain (p)'</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>       ylabel<span class="op">=</span><span class="st">'Probability Density'</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>       title<span class="op">=</span><span class="st">'Beta prior distributions with mean at 0.1'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="conjugate-prior_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="posterior-looks-like-an-updated-prior" class="level2" data-number="28.5">
<h2 data-number="28.5" class="anchored" data-anchor-id="posterior-looks-like-an-updated-prior"><span class="header-section-number">28.5</span> posterior looks like an updated prior</h2>
<p>Why is this distribution particulary convenient? Note that it has the factors <span class="math inline">p^{\alpha - 1}</span> and <span class="math inline">(1-p)^{\beta - 1}</span>, which are similar to the factors in the likelihood function <span class="math inline">p^k (1-p)^{n-k}</span>.</p>
<p>According to Bayes’ theorem, the posterior distribution is proportional to the product of the likelihood and the prior. Thus, if we choose a Beta distribution as the prior, the posterior distribution will also be a Beta distribution, but with updated parameters. Let’s see how this works mathematically:</p>
<p><span class="math display">\begin{align*}
P(p|R=k) &amp;= \frac{1}{\underbrace{P(R=k)}_{\text{evidence}}} \cdot \underbrace{P(R=k|p)}_{\text{likelihood}} \cdot \underbrace{P(p)}_{\text{prior}} \\
&amp;= \frac{1}{P(R=k)} \left( \binom{n}{k} p^k (1-p)^{n-k} \right) \cdot \left( \frac{p^{\alpha - 1} (1-p)^{\beta - 1}}{B(\alpha, \beta)} \right) \\
&amp;= \underbrace{ \frac{1}{P(R=k)} \binom{n}{k} \frac{1}{B(\alpha, \beta)} }_{\text{normalization constant}} p^{k + \alpha - 1} (1-p)^{n - k + \beta - 1}\\
&amp; = \text{Beta}(p | \alpha + k, \beta + n - k) \\
&amp; = \text{Beta}(p | \alpha + \text{successes}, \beta + \text{failures}).
\end{align*}</span></p>
<p>This isn’t magic. We simply chose a prior distribution (Beta) that, when multiplied by the likelihood (Binomial), results in a posterior distribution of the same family (Beta). This property is what defines conjugate priors. Why is this useful?</p>
<ul>
<li><strong>Computational Simplicity:</strong> The posterior distribution can be computed analytically without the need for complex numerical methods.</li>
<li><strong>Intuitive Interpretation:</strong> The parameters of the posterior distribution can be interpreted as updated counts of successes and failures, making it easy to understand how new data influences our beliefs.</li>
</ul>
</section>
<section id="iterative-updating-of-beliefs" class="level2" data-number="28.6">
<h2 data-number="28.6" class="anchored" data-anchor-id="iterative-updating-of-beliefs"><span class="header-section-number">28.6</span> iterative updating of beliefs</h2>
<p>Let’s say that my friends Bob and Alice move to city A, where it rains on 50% of the days. Bob has a prior belief modeled as a Beta distribution with parameters <span class="math inline">\alpha=2</span> and <span class="math inline">\beta=18</span>, reflecting his initial belief that it rains 10% of the days, but with a low level of confidence. Alice, however, has an initial belief closer to the truth, 20%, but with a much higher level of confidence, modeled as a Beta distribution with parameters <span class="math inline">\alpha=100</span> and <span class="math inline">\beta=400</span>. Every week that passes, they observe the weather and write down the number of rainy days, thus collecting the following data over 52 weeks (one year):</p>
<div id="e1cb0ea1" class="cell">
<details class="code-fold">
<summary>generate binomial data for 52 weeks</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>np.random.seed(<span class="dv">6</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>N_weeks <span class="op">=</span> <span class="dv">52</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>success_array_daily <span class="op">=</span> binom.rvs(n<span class="op">=</span><span class="dv">1</span>, p<span class="op">=</span><span class="fl">0.5</span>, size<span class="op">=</span>N_weeks<span class="op">*</span><span class="dv">7</span>)  <span class="co"># first generate daily data</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>success_array <span class="op">=</span> success_array_daily.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">7</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># aggragate to weekly data</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># success_array = binom.rvs(n=7, p=0.5, size=N_weeks)  # do this if you don't need daily data</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>failure_array <span class="op">=</span> <span class="dv">7</span> <span class="op">-</span> success_array</span>
<span id="cb4-7"><a href="#cb4-7"></a>sf_array <span class="op">=</span> np.vstack([success_array, failure_array]).T</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="bu">print</span>(success_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[4 4 5 6 4 4 2 3 5 4 2 3 5 3 3 5 4 3 1 3 4 4 2 2 3 5 1 2 6 4 3 2 3 5 6 3 4
 5 3 5 2 3 4 3 3 5 5 3 5 6 5 2]</code></pre>
</div>
</div>
<p>Now we just use the updating formula iteratively over the 52 weeks of observations:</p>
<div id="f2faabeb" class="cell" data-execution_count="134">
<details class="code-fold">
<summary>update priors over 52 weeks and print parameters</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>bobs_parameters <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">18</span>]])</span>
<span id="cb6-2"><a href="#cb6-2"></a>alices_parameters <span class="op">=</span> np.array([[<span class="dv">100</span>, <span class="dv">400</span>]])</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\t\t</span><span class="st">Bob</span><span class="ch">\t\t</span><span class="st">Bob</span><span class="ch">\t\t</span><span class="st">Alice</span><span class="ch">\t</span><span class="st">Alice"</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="bu">print</span>(<span class="st">"week</span><span class="ch">\t</span><span class="st">alpha</span><span class="ch">\t</span><span class="st">beta</span><span class="ch">\t</span><span class="st">alpha</span><span class="ch">\t</span><span class="st">beta"</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="dv">0</span><span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>bobs_parameters[<span class="dv">0</span>][<span class="dv">0</span>]<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>bobs_parameters[<span class="dv">0</span>][<span class="dv">1</span>]<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>alices_parameters[<span class="dv">0</span>][<span class="dv">0</span>]<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>alices_parameters[<span class="dv">0</span>][<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="cf">for</span> week <span class="kw">in</span> np.arange(N_weeks):</span>
<span id="cb6-7"><a href="#cb6-7"></a>    bobs_last_weeks_parameters <span class="op">=</span> bobs_parameters[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb6-8"><a href="#cb6-8"></a>    bobs_this_weeks_parameters <span class="op">=</span> bobs_last_weeks_parameters <span class="op">+</span> sf_array[week]</span>
<span id="cb6-9"><a href="#cb6-9"></a>    bobs_parameters <span class="op">=</span> np.vstack([bobs_parameters, bobs_this_weeks_parameters])</span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a>    alices_last_weeks_parameters <span class="op">=</span> alices_parameters[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb6-12"><a href="#cb6-12"></a>    alices_this_weeks_parameters <span class="op">=</span> alices_last_weeks_parameters <span class="op">+</span> sf_array[week]</span>
<span id="cb6-13"><a href="#cb6-13"></a>    alices_parameters <span class="op">=</span> np.vstack([alices_parameters, alices_this_weeks_parameters])</span>
<span id="cb6-14"><a href="#cb6-14"></a></span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>week<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>bobs_this_weeks_parameters[<span class="dv">0</span>]<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>bobs_this_weeks_parameters[<span class="dv">1</span>]<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>alices_this_weeks_parameters[<span class="dv">0</span>]<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>alices_this_weeks_parameters[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Bob     Bob     Alice   Alice
week    alpha   beta    alpha   beta
0       2       18      100     400
1       6       21      104     403
2       10      24      108     406
3       15      26      113     408
4       21      27      119     409
5       25      30      123     412
6       29      33      127     415
7       31      38      129     420
8       34      42      132     424
9       39      44      137     426
10      43      47      141     429
11      45      52      143     434
12      48      56      146     438
13      53      58      151     440
14      56      62      154     444
15      59      66      157     448
16      64      68      162     450
17      68      71      166     453
18      71      75      169     457
19      72      81      170     463
20      75      85      173     467
21      79      88      177     470
22      83      91      181     473
23      85      96      183     478
24      87      101     185     483
25      90      105     188     487
26      95      107     193     489
27      96      113     194     495
28      98      118     196     500
29      104     119     202     501
30      108     122     206     504
31      111     126     209     508
32      113     131     211     513
33      116     135     214     517
34      121     137     219     519
35      127     138     225     520
36      130     142     228     524
37      134     145     232     527
38      139     147     237     529
39      142     151     240     533
40      147     153     245     535
41      149     158     247     540
42      152     162     250     544
43      156     165     254     547
44      159     169     257     551
45      162     173     260     555
46      167     175     265     557
47      172     177     270     559
48      175     181     273     563
49      180     183     278     565
50      186     184     284     566
51      191     186     289     568
52      193     191     291     573</code></pre>
</div>
</div>
<p>Finally, we can plot how the probability densities of Bob and Alice are updated over the 52 weeks.</p>
<div id="ce792617" class="cell">
<details class="code-fold">
<summary>ridge plot</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>N_weeks <span class="op">=</span> <span class="dv">52</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>N_panels <span class="op">=</span> N_weeks <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>gs <span class="op">=</span> grid_spec.GridSpec(N_panels,<span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">12</span>))</span>
<span id="cb8-5"><a href="#cb8-5"></a>p <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>bob_colors <span class="op">=</span> mpl.cm.Blues(np.linspace(<span class="fl">0.4</span>,<span class="fl">0.8</span>,N_panels))</span>
<span id="cb8-7"><a href="#cb8-7"></a>alice_colors <span class="op">=</span> mpl.cm.Reds(np.linspace(<span class="fl">0.4</span>,<span class="fl">0.8</span>,N_panels))</span>
<span id="cb8-8"><a href="#cb8-8"></a>ax_objs <span class="op">=</span> []</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="cf">for</span> week <span class="kw">in</span> np.arange(N_panels)[::<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="co"># creating new axes object, start from top = week 52</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>    ax_objs.append(fig.add_subplot(gs[N_panels<span class="op">-</span>week<span class="op">-</span><span class="dv">1</span>:N_panels<span class="op">-</span>week, <span class="dv">0</span>:]))</span>
<span id="cb8-13"><a href="#cb8-13"></a>    </span>
<span id="cb8-14"><a href="#cb8-14"></a>    bobs_params <span class="op">=</span> bobs_parameters[week]</span>
<span id="cb8-15"><a href="#cb8-15"></a>    alices_params <span class="op">=</span> alices_parameters[week]</span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a>    <span class="co"># don't plot the whole distribution, only when greater than threshold</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    range_bob <span class="op">=</span> beta.pdf(p, bobs_params[<span class="dv">0</span>], bobs_params[<span class="dv">1</span>])</span>
<span id="cb8-19"><a href="#cb8-19"></a>    domain <span class="op">=</span> np.where(range_bob <span class="op">&gt;</span> <span class="fl">1e-3</span><span class="op">*</span>np.<span class="bu">max</span>(range_bob))</span>
<span id="cb8-20"><a href="#cb8-20"></a>    ax_objs[<span class="op">-</span><span class="dv">1</span>].fill_between(p[domain], range_bob[domain],</span>
<span id="cb8-21"><a href="#cb8-21"></a>                             color<span class="op">=</span>bob_colors[week], alpha<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb8-22"><a href="#cb8-22"></a>                             clip_on<span class="op">=</span><span class="va">False</span>, ec<span class="op">=</span><span class="st">"white"</span>, zorder<span class="op">=</span>N_panels<span class="op">-</span>week,</span>
<span id="cb8-23"><a href="#cb8-23"></a>                             label<span class="op">=</span><span class="st">"Bob"</span>)</span>
<span id="cb8-24"><a href="#cb8-24"></a>    range_alice <span class="op">=</span> beta.pdf(p, alices_params[<span class="dv">0</span>], alices_params[<span class="dv">1</span>])</span>
<span id="cb8-25"><a href="#cb8-25"></a>    domain <span class="op">=</span> np.where(range_alice <span class="op">&gt;</span> <span class="fl">1e-3</span><span class="op">*</span>np.<span class="bu">max</span>(range_alice))</span>
<span id="cb8-26"><a href="#cb8-26"></a>    ax_objs[<span class="op">-</span><span class="dv">1</span>].fill_between(p[domain], range_alice[domain],</span>
<span id="cb8-27"><a href="#cb8-27"></a>                             color<span class="op">=</span>alice_colors[week], alpha<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb8-28"><a href="#cb8-28"></a>                             clip_on<span class="op">=</span><span class="va">False</span>, ec<span class="op">=</span><span class="st">"white"</span>, zorder<span class="op">=</span>N_panels<span class="op">-</span>week,</span>
<span id="cb8-29"><a href="#cb8-29"></a>                             label<span class="op">=</span><span class="st">"Alice"</span>)</span>
<span id="cb8-30"><a href="#cb8-30"></a></span>
<span id="cb8-31"><a href="#cb8-31"></a>    ax_objs[<span class="op">-</span><span class="dv">1</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),</span>
<span id="cb8-32"><a href="#cb8-32"></a>                    ylim<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">15</span>),</span>
<span id="cb8-33"><a href="#cb8-33"></a>                    yticks<span class="op">=</span>[])</span>
<span id="cb8-34"><a href="#cb8-34"></a>    <span class="cf">if</span> week<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb8-35"><a href="#cb8-35"></a>        ax_objs[<span class="op">-</span><span class="dv">1</span>].set_xticks([])</span>
<span id="cb8-36"><a href="#cb8-36"></a></span>
<span id="cb8-37"><a href="#cb8-37"></a>    <span class="co"># make background transparent</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>    rect <span class="op">=</span> ax_objs[<span class="op">-</span><span class="dv">1</span>].patch</span>
<span id="cb8-39"><a href="#cb8-39"></a>    rect.set_alpha(<span class="dv">0</span>)</span>
<span id="cb8-40"><a href="#cb8-40"></a>    ax_objs[<span class="op">-</span><span class="dv">1</span>].set_yticklabels([])</span>
<span id="cb8-41"><a href="#cb8-41"></a></span>
<span id="cb8-42"><a href="#cb8-42"></a>    <span class="cf">if</span> week <span class="op">==</span> N_panels<span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb8-43"><a href="#cb8-43"></a>        ax_objs[<span class="op">-</span><span class="dv">1</span>].legend(frameon<span class="op">=</span><span class="va">False</span>, loc<span class="op">=</span><span class="st">"upper left"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-44"><a href="#cb8-44"></a>    <span class="cf">if</span> week<span class="op">%</span><span class="dv">4</span><span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb8-45"><a href="#cb8-45"></a>        ax_objs[<span class="op">-</span><span class="dv">1</span>].set_yticks([<span class="dv">0</span>])</span>
<span id="cb8-46"><a href="#cb8-46"></a>        ax_objs[<span class="op">-</span><span class="dv">1</span>].set_yticklabels([<span class="ss">f"week </span><span class="sc">{</span>week<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb8-47"><a href="#cb8-47"></a>        ax_objs[<span class="op">-</span><span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">'y'</span>, length<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-48"><a href="#cb8-48"></a>        ax_objs[<span class="op">-</span><span class="dv">1</span>].axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"black"</span>, lw<span class="op">=</span><span class="dv">1</span>, zorder<span class="op">=</span>N_panels<span class="op">-</span>week<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb8-49"><a href="#cb8-49"></a>    spines <span class="op">=</span> [<span class="st">"top"</span>,<span class="st">"right"</span>,<span class="st">"left"</span>,<span class="st">"bottom"</span>]</span>
<span id="cb8-50"><a href="#cb8-50"></a>    <span class="cf">for</span> s <span class="kw">in</span> spines:</span>
<span id="cb8-51"><a href="#cb8-51"></a>        ax_objs[<span class="op">-</span><span class="dv">1</span>].spines[s].set_visible(<span class="va">False</span>)</span>
<span id="cb8-52"><a href="#cb8-52"></a></span>
<span id="cb8-53"><a href="#cb8-53"></a>ax_objs[<span class="op">-</span><span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Probability densities updated over 52 weeks'</span>)</span>
<span id="cb8-54"><a href="#cb8-54"></a>gs.update(hspace<span class="op">=-</span><span class="fl">0.7</span>)</span>
<span id="cb8-55"><a href="#cb8-55"></a></span>
<span id="cb8-56"><a href="#cb8-56"></a>ax_top <span class="op">=</span> ax_objs[<span class="dv">0</span>]</span>
<span id="cb8-57"><a href="#cb8-57"></a>ax_bottom <span class="op">=</span> ax_objs[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb8-58"><a href="#cb8-58"></a>pos_top <span class="op">=</span> ax_top.get_position().extents <span class="co"># left, bottom, right, top</span></span>
<span id="cb8-59"><a href="#cb8-59"></a>pos_bottom <span class="op">=</span> ax_bottom.get_position().extents <span class="co"># left, bottom, right, top</span></span>
<span id="cb8-60"><a href="#cb8-60"></a>x_dotted_lines <span class="op">=</span> [<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>]</span>
<span id="cb8-61"><a href="#cb8-61"></a><span class="cf">for</span> x <span class="kw">in</span> x_dotted_lines:</span>
<span id="cb8-62"><a href="#cb8-62"></a>    display_coord <span class="op">=</span> ax_bottom.transData.transform([x, <span class="fl">0.0</span>])  <span class="co"># convert data coordinates to display coordinates</span></span>
<span id="cb8-63"><a href="#cb8-63"></a>    fig_coord <span class="op">=</span> fig.transFigure.inverted().transform(display_coord)  <span class="co"># convert display coordinates to figure coordinates</span></span>
<span id="cb8-64"><a href="#cb8-64"></a>    line <span class="op">=</span> Line2D([fig_coord[<span class="dv">0</span>], fig_coord[<span class="dv">0</span>]],     <span class="co"># x coordinates</span></span>
<span id="cb8-65"><a href="#cb8-65"></a>                [fig_coord[<span class="dv">1</span>], pos_top[<span class="dv">1</span>]],          <span class="co"># y coordinates</span></span>
<span id="cb8-66"><a href="#cb8-66"></a>                transform<span class="op">=</span>fig.transFigure, color<span class="op">=</span><span class="st">'black'</span>, ls<span class="op">=</span><span class="st">':'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb8-67"><a href="#cb8-67"></a>    fig.add_artist(line)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="conjugate-prior_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Although Alice starts with a more accurate prior, Bob’s belief converges faster towards the true probability of rain (50%) over time, because his prior at week 0 was less confident (more spread out), allowing new evidence to have a greater impact on his posterior belief. For each person’s pdf, we can plot its mean and standard deviation over time. For a Beta distribution <span class="math inline">\text{Beta}(p|\alpha, \beta)</span>, the mean and variance are given by:</p>
<p><span class="math display">\begin{align*}
\text{mean} &amp;= \frac{\alpha}{\alpha + \beta}, \\
\text{variance} &amp;= \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)}.
\end{align*}</span></p>
<div id="01315d6d" class="cell">
<details class="code-fold">
<summary>Bob and Alice’s estimates over time</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb9-2"><a href="#cb9-2"></a>t <span class="op">=</span> np.arange(N_weeks<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">def</span> beta_mean(alpha, beta):</span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="cf">return</span> alpha <span class="op">/</span> (alpha <span class="op">+</span> beta)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">def</span> beta_variance(alpha, beta):</span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="cf">return</span> (alpha <span class="op">*</span> beta) <span class="op">/</span> ((alpha <span class="op">+</span> beta)<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (alpha <span class="op">+</span> beta <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a>bob_means <span class="op">=</span> beta_mean(bobs_parameters[:,<span class="dv">0</span>], bobs_parameters[:,<span class="dv">1</span>])</span>
<span id="cb9-10"><a href="#cb9-10"></a>bob_sqrt_variance <span class="op">=</span> np.sqrt(beta_variance(bobs_parameters[:,<span class="dv">0</span>], bobs_parameters[:,<span class="dv">1</span>]))</span>
<span id="cb9-11"><a href="#cb9-11"></a>alice_means <span class="op">=</span> beta_mean(alices_parameters[:,<span class="dv">0</span>], alices_parameters[:,<span class="dv">1</span>])</span>
<span id="cb9-12"><a href="#cb9-12"></a>alice_sqrt_variance <span class="op">=</span> np.sqrt(beta_variance(alices_parameters[:,<span class="dv">0</span>], alices_parameters[:,<span class="dv">1</span>]))</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a>line_bob, <span class="op">=</span> ax.plot(t, bob_means, color<span class="op">=</span><span class="st">"tab:blue"</span>, label<span class="op">=</span><span class="st">"Bob's Mean"</span>)</span>
<span id="cb9-15"><a href="#cb9-15"></a>fill_bob <span class="op">=</span> ax.fill_between(t, bob_means <span class="op">-</span> bob_sqrt_variance, bob_means <span class="op">+</span> bob_sqrt_variance,</span>
<span id="cb9-16"><a href="#cb9-16"></a>                color<span class="op">=</span><span class="st">"tab:blue"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, label<span class="op">=</span><span class="st">"Bob's Std Dev"</span>)</span>
<span id="cb9-17"><a href="#cb9-17"></a>line_alice, <span class="op">=</span> ax.plot(t, alice_means, color<span class="op">=</span><span class="st">"tab:red"</span>, label<span class="op">=</span><span class="st">"Alice's Mean"</span>)</span>
<span id="cb9-18"><a href="#cb9-18"></a>fill_alice <span class="op">=</span> ax.fill_between(t, alice_means <span class="op">-</span> alice_sqrt_variance, alice_means <span class="op">+</span> alice_sqrt_variance,</span>
<span id="cb9-19"><a href="#cb9-19"></a>                color<span class="op">=</span><span class="st">"tab:red"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, label<span class="op">=</span><span class="st">"Alice's Std Dev"</span>)</span>
<span id="cb9-20"><a href="#cb9-20"></a></span>
<span id="cb9-21"><a href="#cb9-21"></a>ax.axhline(<span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"black"</span>, ls<span class="op">=</span><span class="st">"--"</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-22"><a href="#cb9-22"></a>ax.legend([(line_bob, fill_bob), (line_alice, fill_alice)],</span>
<span id="cb9-23"><a href="#cb9-23"></a>          [<span class="vs">r"Bob's mean</span><span class="dv">$</span><span class="er">\</span><span class="vs">pm</span><span class="dv">$</span><span class="vs">std"</span>, <span class="vs">r"Alice's mean</span><span class="dv">$</span><span class="er">\</span><span class="vs">pm</span><span class="dv">$</span><span class="vs">std"</span>],</span>
<span id="cb9-24"><a href="#cb9-24"></a>          handler_map<span class="op">=</span>{<span class="bu">tuple</span>: mpl.legend_handler.HandlerTuple(ndivide<span class="op">=</span><span class="dv">1</span>)},</span>
<span id="cb9-25"><a href="#cb9-25"></a>          frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-26"><a href="#cb9-26"></a></span>
<span id="cb9-27"><a href="#cb9-27"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Weeks'</span>,</span>
<span id="cb9-28"><a href="#cb9-28"></a>       ylabel<span class="op">=</span><span class="st">'Estimated Expected Probability of Rain'</span>,</span>
<span id="cb9-29"><a href="#cb9-29"></a>       title<span class="op">=</span><span class="st">'Convergence of Bob and Alice</span><span class="ch">\'</span><span class="st">s Estimates Over Time'</span>,</span>
<span id="cb9-30"><a href="#cb9-30"></a>       ylim<span class="op">=</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),</span>
<span id="cb9-31"><a href="#cb9-31"></a>       xlim<span class="op">=</span>(<span class="dv">0</span>,N_weeks))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="conjugate-prior_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparison-with-frequentist-approach" class="level2" data-number="28.7">
<h2 data-number="28.7" class="anchored" data-anchor-id="comparison-with-frequentist-approach"><span class="header-section-number">28.7</span> comparison with frequentist approach</h2>
<p>Let’s add to the graph above one more line, for Charlie, who follows a frequentist approach to estimate the probability of rain over time. Charlie doesn’t have any prior belief; instead, he simply counts the number of rainy days observed so far (<span class="math inline">k</span>) and divides it by the total number of days that passed (<span class="math inline">n</span>). As shown in the chapter <a href="../likelihood/MLE_and_summary_statistics.html#binomial-distribution">MLE and summary statistics</a>, when assuming a generative model that is a Bernoulli process (or Binomial distribution for multiple trials), the maximum likelihood estimate (MLE) of the probability of success (rain) is given by the ratio of the number of successes to the total number of trials:</p>
<p><span class="math display">
\hat{p} = \frac{k}{n}.
</span></p>
<p>The conclusion here is that, even if Charlied doesn’t know it, his estimate is based on the Maximum Likelihood Estimation (MLE) principle.</p>
<p>This time, instead of plotting the weekly estimates, let’s see what happens if each of the residents of city A updates their beliefs daily.</p>
<div id="938ec66b" class="cell">
<details class="code-fold">
<summary>compute daily parameter updates for Bob and Alice</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>failure_array_daily <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> success_array_daily</span>
<span id="cb10-2"><a href="#cb10-2"></a>sf_array_daily <span class="op">=</span> np.vstack([success_array_daily, failure_array_daily]).T</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a>bobs_parameters_daily <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">18</span>]])</span>
<span id="cb10-5"><a href="#cb10-5"></a>alices_parameters_daily <span class="op">=</span> np.array([[<span class="dv">100</span>, <span class="dv">400</span>]])</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="cf">for</span> day <span class="kw">in</span> np.arange(N_weeks<span class="op">*</span><span class="dv">7</span>):</span>
<span id="cb10-8"><a href="#cb10-8"></a>    bobs_yesterdays_parameters <span class="op">=</span> bobs_parameters_daily[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb10-9"><a href="#cb10-9"></a>    bobs_todays_parameters <span class="op">=</span> bobs_yesterdays_parameters <span class="op">+</span> sf_array_daily[day]</span>
<span id="cb10-10"><a href="#cb10-10"></a>    bobs_parameters_daily <span class="op">=</span> np.vstack([bobs_parameters_daily, bobs_todays_parameters])</span>
<span id="cb10-11"><a href="#cb10-11"></a>    alices_yesterdays_parameters <span class="op">=</span> alices_parameters_daily[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb10-12"><a href="#cb10-12"></a>    alices_todays_parameters <span class="op">=</span> alices_yesterdays_parameters <span class="op">+</span> sf_array_daily[day]</span>
<span id="cb10-13"><a href="#cb10-13"></a>    alices_parameters_daily <span class="op">=</span> np.vstack([alices_parameters_daily, alices_todays_parameters])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="c8a1e3cc" class="cell" data-execution_count="156">
<details class="code-fold">
<summary>frequentist vs Bayesian daily updates</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>t <span class="op">=</span> <span class="dv">7</span><span class="op">*</span>np.arange(N_weeks<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a>t_day<span class="op">=</span> np.arange(N_weeks<span class="op">*</span><span class="dv">7</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a>bob_means_daily <span class="op">=</span> beta_mean(bobs_parameters_daily[:,<span class="dv">0</span>], bobs_parameters_daily[:,<span class="dv">1</span>])</span>
<span id="cb11-8"><a href="#cb11-8"></a>bob_sqrt_variance_daily <span class="op">=</span> np.sqrt(beta_variance(bobs_parameters_daily[:,<span class="dv">0</span>], bobs_parameters_daily[:,<span class="dv">1</span>]))</span>
<span id="cb11-9"><a href="#cb11-9"></a>alice_means_daily <span class="op">=</span> beta_mean(alices_parameters_daily[:,<span class="dv">0</span>], alices_parameters_daily[:,<span class="dv">1</span>])</span>
<span id="cb11-10"><a href="#cb11-10"></a>alice_sqrt_variance_daily <span class="op">=</span> np.sqrt(beta_variance(alices_parameters_daily[:,<span class="dv">0</span>], alices_parameters_daily[:,<span class="dv">1</span>]))</span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a>line_bob_daily, <span class="op">=</span> ax.plot(t_day, bob_means_daily, color<span class="op">=</span><span class="st">"tab:blue"</span>, label<span class="op">=</span><span class="st">"Bob's Mean (Daily)"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, ls<span class="op">=</span><span class="st">"-"</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a>fill_bob_daily <span class="op">=</span> ax.fill_between(t_day, bob_means_daily <span class="op">-</span> bob_sqrt_variance_daily, bob_means_daily <span class="op">+</span> bob_sqrt_variance_daily,</span>
<span id="cb11-14"><a href="#cb11-14"></a>                color<span class="op">=</span><span class="st">"tab:blue"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, label<span class="op">=</span><span class="st">"Bob's Std Dev"</span>)</span>
<span id="cb11-15"><a href="#cb11-15"></a>line_alice_daily, <span class="op">=</span> ax.plot(t_day, alice_means_daily, color<span class="op">=</span><span class="st">"tab:red"</span>, label<span class="op">=</span><span class="st">"Alice's Mean (Daily)"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, ls<span class="op">=</span><span class="st">"-"</span>)</span>
<span id="cb11-16"><a href="#cb11-16"></a>fill_alice_daily <span class="op">=</span> ax.fill_between(t_day, alice_means_daily <span class="op">-</span> alice_sqrt_variance_daily, alice_means_daily <span class="op">+</span> alice_sqrt_variance_daily,</span>
<span id="cb11-17"><a href="#cb11-17"></a>                color<span class="op">=</span><span class="st">"tab:red"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, label<span class="op">=</span><span class="st">"Alice's Std Dev"</span>)</span>
<span id="cb11-18"><a href="#cb11-18"></a></span>
<span id="cb11-19"><a href="#cb11-19"></a>bob_parameters_frequentist <span class="op">=</span> bobs_parameters_daily <span class="op">-</span> bobs_parameters_daily[<span class="dv">0</span>]</span>
<span id="cb11-20"><a href="#cb11-20"></a>bob_means_frequentist <span class="op">=</span> bob_parameters_frequentist[<span class="dv">1</span>:,<span class="dv">0</span>] <span class="op">/</span> (bob_parameters_frequentist[<span class="dv">1</span>:,<span class="dv">0</span>] <span class="op">+</span> bob_parameters_frequentist[<span class="dv">1</span>:,<span class="dv">1</span>])</span>
<span id="cb11-21"><a href="#cb11-21"></a>line_bob_frequentist, <span class="op">=</span> ax.plot(t_day[<span class="dv">1</span>:], bob_means_frequentist, color<span class="op">=</span><span class="st">"purple"</span>, label<span class="op">=</span><span class="st">"Bob's Frequentist Estimate"</span>, ls<span class="op">=</span><span class="st">"-"</span>, marker<span class="op">=</span><span class="st">"o"</span>, markersize<span class="op">=</span><span class="dv">3</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-22"><a href="#cb11-22"></a></span>
<span id="cb11-23"><a href="#cb11-23"></a>ax.axhline(<span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"black"</span>, ls<span class="op">=</span><span class="st">"--"</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-24"><a href="#cb11-24"></a>ax.legend([(line_bob_daily, fill_bob_daily), (line_alice_daily, fill_alice_daily), (line_bob_frequentist,)],</span>
<span id="cb11-25"><a href="#cb11-25"></a>          [<span class="vs">r"Bob's mean</span><span class="dv">$</span><span class="er">\</span><span class="vs">pm</span><span class="dv">$</span><span class="vs">std"</span>, <span class="vs">r"Alice's mean</span><span class="dv">$</span><span class="er">\</span><span class="vs">pm</span><span class="dv">$</span><span class="vs">std"</span>, <span class="st">"Charlie, the frequentist"</span>],</span>
<span id="cb11-26"><a href="#cb11-26"></a>          handler_map<span class="op">=</span>{<span class="bu">tuple</span>: mpl.legend_handler.HandlerTuple(ndivide<span class="op">=</span><span class="dv">1</span>)},</span>
<span id="cb11-27"><a href="#cb11-27"></a>          frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-28"><a href="#cb11-28"></a></span>
<span id="cb11-29"><a href="#cb11-29"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Days'</span>,</span>
<span id="cb11-30"><a href="#cb11-30"></a>       ylabel<span class="op">=</span><span class="st">'Estimated Expected Probability of Rain'</span>,</span>
<span id="cb11-31"><a href="#cb11-31"></a>       title<span class="op">=</span><span class="st">'Frequentist vs Bayesian Daily Updates'</span>,</span>
<span id="cb11-32"><a href="#cb11-32"></a>       ylim<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb11-33"><a href="#cb11-33"></a>       xlim<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">150</span>)</span>
<span id="cb11-34"><a href="#cb11-34"></a>       )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="conjugate-prior_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s digest what we see above.</p>
<ul>
<li>The frequentist approach does not use prior beliefs, it simply estimates the probability based on the observed data.</li>
<li>At day zero, Bob and Alice have beliefs about the world, but Charlie doesn’t have any data to base his estimate on, so we see nothing for him at day zero.</li>
<li>The very first day was a rainy day, so Charlie’s estimate begins at 100%.</li>
<li>In the following days, Charlie’s estimate fluctuates more wildly than Bob’s and Alice’s, especially in the early weeks when the amount of data is still small. As more data is collected, Charlie’s estimate stabilizes and converges towards the true probability of rain (50%).</li>
<li>As the number of observations increases, all three estimates (Bob’s, Alice’s, and Charlie’s) converge towards the true probability of rain (50%).</li>
</ul>
<p>Pierre-Simon Laplace came up with a solution to Charlie’s “small sample size” problem, where he estimates 100% probability of rain on day one. Laplace did that in a similar context, answering the question “will the sun rise tomorrow?”. Instead of not assuming anything like Charlie, Laplace proposes the “rule of succession”, which says that we assume one success and one failure even before observing any data. Translating that to a Beta prior, it means starting with <span class="math inline">\alpha=1</span> and <span class="math inline">\beta=1</span>, which is a uniform prior over <span class="math inline">p</span>, see the graph below.</p>
<div id="439b5a19" class="cell" data-execution_count="155">
<details class="code-fold">
<summary>Laplace vs frequentist vs Bayesian daily updates</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>laplaces_parameters_daily <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="cf">for</span> day <span class="kw">in</span> np.arange(N_weeks<span class="op">*</span><span class="dv">7</span>):</span>
<span id="cb12-3"><a href="#cb12-3"></a>    laplaces_yesterdays_parameters <span class="op">=</span> laplaces_parameters_daily[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb12-4"><a href="#cb12-4"></a>    laplaces_todays_parameters <span class="op">=</span> laplaces_yesterdays_parameters <span class="op">+</span> sf_array_daily[day]</span>
<span id="cb12-5"><a href="#cb12-5"></a>    laplaces_parameters_daily <span class="op">=</span> np.vstack([laplaces_parameters_daily, laplaces_todays_parameters])</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a>laplaces_means_daily <span class="op">=</span> beta_mean(laplaces_parameters_daily[:,<span class="dv">0</span>], laplaces_parameters_daily[:,<span class="dv">1</span>])</span>
<span id="cb12-10"><a href="#cb12-10"></a>laplaces_sqrt_variance_daily <span class="op">=</span> np.sqrt(beta_variance(laplaces_parameters_daily[:,<span class="dv">0</span>], laplaces_parameters_daily[:,<span class="dv">1</span>]))</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a>line_bob_daily, <span class="op">=</span> ax[<span class="dv">0</span>].plot(t_day, bob_means_daily, color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"Bob's Mean (Daily)"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, ls<span class="op">=</span><span class="st">"-"</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a>fill_bob_daily <span class="op">=</span> ax[<span class="dv">0</span>].fill_between(t_day, bob_means_daily <span class="op">-</span> bob_sqrt_variance_daily, bob_means_daily <span class="op">+</span> bob_sqrt_variance_daily,</span>
<span id="cb12-14"><a href="#cb12-14"></a>                color<span class="op">=</span><span class="st">"tab:blue"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, label<span class="op">=</span><span class="st">"Bob's Std Dev"</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a>line_alice_daily, <span class="op">=</span> ax[<span class="dv">0</span>].plot(t_day, alice_means_daily, color<span class="op">=</span><span class="st">"black"</span>, label<span class="op">=</span><span class="st">"Alice's Mean (Daily)"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, ls<span class="op">=</span><span class="st">"-"</span>)</span>
<span id="cb12-16"><a href="#cb12-16"></a>fill_alice_daily <span class="op">=</span> ax[<span class="dv">0</span>].fill_between(t_day, alice_means_daily <span class="op">-</span> alice_sqrt_variance_daily, alice_means_daily <span class="op">+</span> alice_sqrt_variance_daily,</span>
<span id="cb12-17"><a href="#cb12-17"></a>                color<span class="op">=</span><span class="st">"tab:red"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, label<span class="op">=</span><span class="st">"Alice's Std Dev"</span>)</span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a>bob_parameters_frequentist <span class="op">=</span> bobs_parameters_daily <span class="op">-</span> bobs_parameters_daily[<span class="dv">0</span>]</span>
<span id="cb12-20"><a href="#cb12-20"></a>bob_means_frequentist <span class="op">=</span> bob_parameters_frequentist[<span class="dv">1</span>:,<span class="dv">0</span>] <span class="op">/</span> (bob_parameters_frequentist[<span class="dv">1</span>:,<span class="dv">0</span>] <span class="op">+</span> bob_parameters_frequentist[<span class="dv">1</span>:,<span class="dv">1</span>])</span>
<span id="cb12-21"><a href="#cb12-21"></a>line_bob_frequentist, <span class="op">=</span> ax[<span class="dv">0</span>].plot(t_day[<span class="dv">1</span>:], bob_means_frequentist, color<span class="op">=</span><span class="st">"purple"</span>, label<span class="op">=</span><span class="st">"Bob's Frequentist Estimate"</span>, ls<span class="op">=</span><span class="st">"-"</span>, marker<span class="op">=</span><span class="st">"o"</span>, markersize<span class="op">=</span><span class="dv">3</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a>line_laplaces_daily, <span class="op">=</span> ax[<span class="dv">0</span>].plot(t_day, laplaces_means_daily, color<span class="op">=</span><span class="st">"tab:orange"</span>, label<span class="op">=</span><span class="st">"Laplace's Mean (Daily)"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, ls<span class="op">=</span><span class="st">"-"</span>)</span>
<span id="cb12-24"><a href="#cb12-24"></a>fill_laplaces_daily <span class="op">=</span> ax[<span class="dv">0</span>].fill_between(t_day, laplaces_means_daily <span class="op">-</span> laplaces_sqrt_variance_daily, laplaces_means_daily <span class="op">+</span> laplaces_sqrt_variance_daily,</span>
<span id="cb12-25"><a href="#cb12-25"></a>                color<span class="op">=</span><span class="st">"tab:orange"</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, label<span class="op">=</span><span class="st">"Laplace's Std Dev"</span>)</span>
<span id="cb12-26"><a href="#cb12-26"></a></span>
<span id="cb12-27"><a href="#cb12-27"></a>ax[<span class="dv">0</span>].axhline(<span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"black"</span>, ls<span class="op">=</span><span class="st">"--"</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-28"><a href="#cb12-28"></a>ax[<span class="dv">0</span>].legend([(line_bob_daily, fill_bob_daily), (line_alice_daily, fill_alice_daily), (line_bob_frequentist,), (line_laplaces_daily, fill_laplaces_daily)],</span>
<span id="cb12-29"><a href="#cb12-29"></a>          [<span class="vs">r"Bob's mean</span><span class="dv">$</span><span class="er">\</span><span class="vs">pm</span><span class="dv">$</span><span class="vs">std"</span>, <span class="vs">r"Alice's mean</span><span class="dv">$</span><span class="er">\</span><span class="vs">pm</span><span class="dv">$</span><span class="vs">std"</span>, <span class="st">"Charlie, the frequentist"</span>, <span class="st">"Laplace"</span>],</span>
<span id="cb12-30"><a href="#cb12-30"></a>          handler_map<span class="op">=</span>{<span class="bu">tuple</span>: mpl.legend_handler.HandlerTuple(ndivide<span class="op">=</span><span class="dv">1</span>)},</span>
<span id="cb12-31"><a href="#cb12-31"></a>          frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-32"><a href="#cb12-32"></a></span>
<span id="cb12-33"><a href="#cb12-33"></a>ax[<span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Days'</span>,</span>
<span id="cb12-34"><a href="#cb12-34"></a>       ylabel<span class="op">=</span><span class="st">'Estimated Expected Probability of Rain'</span>,</span>
<span id="cb12-35"><a href="#cb12-35"></a>       title<span class="op">=</span><span class="st">'Frequentist vs Bayesian Daily Updates'</span>,</span>
<span id="cb12-36"><a href="#cb12-36"></a>       ylim<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-37"><a href="#cb12-37"></a>       xlim<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">20</span>)</span>
<span id="cb12-38"><a href="#cb12-38"></a>       )<span class="op">;</span></span>
<span id="cb12-39"><a href="#cb12-39"></a></span>
<span id="cb12-40"><a href="#cb12-40"></a>p <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb12-41"><a href="#cb12-41"></a>ax[<span class="dv">1</span>].plot(p, beta.pdf(p, laplaces_parameters_daily[<span class="dv">0</span>,<span class="dv">0</span>], laplaces_parameters_daily[<span class="dv">0</span>,<span class="dv">1</span>]), label<span class="op">=</span><span class="st">'Beta(1, 1) - Laplace'</span>, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb12-42"><a href="#cb12-42"></a>ax[<span class="dv">1</span>].plot(p, beta.pdf(p, bobs_parameters_daily[<span class="dv">0</span>,<span class="dv">0</span>], bobs_parameters_daily[<span class="dv">0</span>,<span class="dv">1</span>]), label<span class="op">=</span><span class="ss">f'Beta(</span><span class="sc">{</span>bobs_parameters_daily[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>bobs_parameters_daily[<span class="dv">0</span>,<span class="dv">1</span>]<span class="sc">}</span><span class="ss">) - Bob'</span>, color<span class="op">=</span><span class="st">"tab:orange"</span>)</span>
<span id="cb12-43"><a href="#cb12-43"></a>ax[<span class="dv">1</span>].plot(p, beta.pdf(p, alices_parameters_daily[<span class="dv">0</span>,<span class="dv">0</span>], alices_parameters_daily[<span class="dv">0</span>,<span class="dv">1</span>]), label<span class="op">=</span><span class="ss">f'Beta(</span><span class="sc">{</span>alices_parameters_daily[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>alices_parameters_daily[<span class="dv">0</span>,<span class="dv">1</span>]<span class="sc">}</span><span class="ss">) - Alice'</span>, color<span class="op">=</span><span class="st">"tab:blue"</span>)</span>
<span id="cb12-44"><a href="#cb12-44"></a>ax[<span class="dv">1</span>].legend(frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-45"><a href="#cb12-45"></a>ax[<span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Probability of rain (p)'</span>,</span>
<span id="cb12-46"><a href="#cb12-46"></a>       ylabel<span class="op">=</span><span class="st">'Probability Density'</span>,</span>
<span id="cb12-47"><a href="#cb12-47"></a>       title<span class="op">=</span><span class="st">'Beta prior distributions with mean at 0.1'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="conjugate-prior_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Laplace’s estimate doesn’t suffer from Charlie’s extreme initial estimate. Just after a few days, however, it is almost indistinguishable from Charlie’s estimate.</p>
</section>
<section id="conjugate-pairs" class="level2" data-number="28.8">
<h2 data-number="28.8" class="anchored" data-anchor-id="conjugate-pairs"><span class="header-section-number">28.8</span> conjugate pairs</h2>
<p>In the example above, we saw how convenient it is to use a prior function that is conjugate to the likelihood function. The generating process behind the observations was a Bernoulli process (or Binomial distribution for multiple trials), so we chose its conjugate, the Beta distribution.</p>
<p>Some examples of processes that can be described by a Binomial distribution (or Bernoulli process) are:</p>
<ul>
<li><strong>Conversion Rates:</strong> A marketing team has a prior belief about how many people will click an email link (Success) vs.&nbsp;ignore it (Failure).</li>
<li><strong>Quality Control:</strong> A factory manager has a prior belief about the proportion of defective items (Success) vs.&nbsp;non-defective items (Failure) in a production batch.</li>
<li><strong>Medical Trials:</strong> A researcher has a prior belief about the effectiveness of a new drug (Success) vs.&nbsp;ineffectiveness (Failure) based on preliminary studies.</li>
</ul>
<p>What if the generating process was different?</p>
<section id="poisson-distribution" class="level3" data-number="28.8.1">
<h3 data-number="28.8.1" class="anchored" data-anchor-id="poisson-distribution"><span class="header-section-number">28.8.1</span> Poisson distribution</h3>
<p>The Poisson distribution models the number of events occurring in a fixed interval of time or space (the “count”). The Gamma distribution is its conjugate prior because it is defined for positive values (0 to <span class="math inline">\infty</span>), making it perfect for modeling the rate (<span class="math inline">\lambda</span>) at which these events happen. It can be used in scenarios such as:</p>
<ul>
<li><strong>Ecohydrology:</strong> Modeling the number of rainfall pulses in a desert ecosystem during the growing season.</li>
<li><strong>Customer Service:</strong> Estimating the rate of phone calls arriving at a help desk per hour.</li>
<li><strong>Radioactive Decay:</strong> Predicting the number of particles emitted by a substance over a specific duration.</li>
</ul>
</section>
<section id="normal-distribution-known-variance" class="level3" data-number="28.8.2">
<h3 data-number="28.8.2" class="anchored" data-anchor-id="normal-distribution-known-variance"><span class="header-section-number">28.8.2</span> normal distribution (known variance)</h3>
<p>When you assume your data follows a Normal distribution (like measurement errors) and you know the variance, the conjugate prior for the mean is also a Normal distribution. This creates a beautiful “weighted average” effect: the posterior mean will sit somewhere between your prior guess and the data’s mean, depending on which one is more certain. It is useful in scenarios such as:</p>
<ul>
<li><strong>Measurement Errors:</strong> Estimating the true value of a physical quantity when measurements are subject to random errors.</li>
<li><strong>Quality Control:</strong> Determining the average weight of products in a manufacturing process where individual weights vary normally around a true mean.</li>
<li><strong>Psychometrics:</strong> Estimating the average score of a psychological test when individual scores are normally distributed with known variance.</li>
</ul>
</section>
<section id="categorical-multinomial-distribution" class="level3" data-number="28.8.3">
<h3 data-number="28.8.3" class="anchored" data-anchor-id="categorical-multinomial-distribution"><span class="header-section-number">28.8.3</span> categorical / multinomial distribution</h3>
<p>This is the multi-dimensional version of the Beta distribution. Instead of just “Success/Failure,” you have multiple categories (e.g., “Rain/Sun/Clouds”). The Dirichlet distribution allows you to track the probabilities of all these categories simultaneously. It is useful in scenarios such as:</p>
<ul>
<li><strong>Topic Modeling:</strong> In Machine Learning, determining the “theme” of a document by looking at the frequency of different words (each word is a category).</li>
<li><strong>Political Polling:</strong> Estimating the support for four different candidates in an upcoming election.</li>
<li><strong>Genetics:</strong> Modeling the frequency of different alleles (gene variants) within a specific population.</li>
</ul>
</section>
</section>
<section id="uniform-distribution-known-bounds" class="level2" data-number="28.9">
<h2 data-number="28.9" class="anchored" data-anchor-id="uniform-distribution-known-bounds"><span class="header-section-number">28.9</span> uniform distribution (known bounds)</h2>
<p>This is used when you are trying to find the maximum possible value (<span class="math inline">\theta</span>) of a process. If you assume the data is spread evenly (Uniform) up to some unknown limit, the Pareto distribution is the conjugate prior that helps you “narrow in” on where that upper limit actually sits. It is useful in scenarios such as:</p>
<ul>
<li><strong>The German Tank Problem:</strong> Estimating the total number of tanks produced by an enemy based on the highest serial number found on captured tanks.</li>
<li><strong>Ecological Limits:</strong> Estimating the maximum possible size a specific fish species can reach based on the largest specimens caught.</li>
<li><strong>Quality Control:</strong> Determining the maximum defect size in a batch of manufactured items based on the largest defect observed in a sample.</li>
<li><strong>Project Management:</strong> Estimating the maximum time required to complete a project based on the longest time taken for similar past projects.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../bayes/logistic-connection.html" class="pagination-link" aria-label="logistic connection">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">logistic connection</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../bayes/boy-girl-paradox.html" class="pagination-link" aria-label="the boy-girl paradox">
        <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">the boy-girl paradox</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>